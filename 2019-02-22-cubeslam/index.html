<!DOCTYPE html>
<html lang="zh-cn">
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <title> ğŸ˜œ Cube SLAM ä»£ç æ€»ç»“ï¼šå¦‚ä½•ä» 2D ç›®æ ‡æ£€æµ‹æ¢å¤ 3D ç‰©ä½“ä½å§¿ - å´è¨€å´è¯­</title>
  <meta name="renderer" content="webkit" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>

<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />

<meta name="theme-color" content="#f8f5ec" />
<meta name="msapplication-navbutton-color" content="#f8f5ec">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="#f8f5ec">


<meta name="author" content="wuxiaolang" /><meta name="description" content="æ³¨ï¼šğŸŒ Cube SLAM ç³»åˆ—è®ºæ–‡ï¼Œä»£ç æ³¨é‡Šã€æ€»ç»“æ±‡æ€» 0. å‡½æ•° 0.1. å‡½æ•°è°ƒç”¨ main_obj.cpp æ–‡ä»¶ä¸­ detect_cuboid_obj.detect_cuboid(); å¼€å§‹è¿›è¡Œç‰©ä½“ç«‹æ–¹ä½“ç»“æ„æ£€æµ‹ï¼› detect_cuboid_obj æ˜¯ç«‹æ–¹ä½“æ£€æµ‹ç±»ï¼ˆå®šä¹‰åœ¨ detect_3d_cuboid.h ä¸­ï¼‰ detect_3d_cuboid çš„ä¸€ä¸ªå¯¹è±¡ï¼› 1 detect_cuboid_obj.detect_cuboid(raw_rgb_img,transToWolrd,raw_2d_objs,all_lines_raw," /><meta name="keywords" content="Hugo, theme, even" />


<meta name="baidu-site-verification" content="fHOS0ah0i1" />
<meta name="google-site-verification" content="4aEA7KB3m7LrWKNH4axTcMxXigooU2CLbEs_pmc_09s" />


<meta name="generator" content="Hugo 0.68.0 with theme even" />


<link rel="canonical" href="https://wym.netlify.app/2019-02-22-cubeslam/" />
<link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
<link rel="manifest" href="/manifest.json">
<link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5">

<script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
<link href="/dist/even.fdd8141c.min.css" rel="stylesheet">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.1.20/dist/jquery.fancybox.min.css" integrity="sha256-7TyXnr2YU040zfSP+rEcz29ggW4j56/ujTPwjMzyqFY=" crossorigin="anonymous">


<meta property="og:title" content=" ğŸ˜œ Cube SLAM ä»£ç æ€»ç»“ï¼šå¦‚ä½•ä» 2D ç›®æ ‡æ£€æµ‹æ¢å¤ 3D ç‰©ä½“ä½å§¿" />
<meta property="og:description" content="æ³¨ï¼šğŸŒ Cube SLAM ç³»åˆ—è®ºæ–‡ï¼Œä»£ç æ³¨é‡Šã€æ€»ç»“æ±‡æ€» 0. å‡½æ•° 0.1. å‡½æ•°è°ƒç”¨ main_obj.cpp æ–‡ä»¶ä¸­ detect_cuboid_obj.detect_cuboid(); å¼€å§‹è¿›è¡Œç‰©ä½“ç«‹æ–¹ä½“ç»“æ„æ£€æµ‹ï¼› detect_cuboid_obj æ˜¯ç«‹æ–¹ä½“æ£€æµ‹ç±»ï¼ˆå®šä¹‰åœ¨ detect_3d_cuboid.h ä¸­ï¼‰ detect_3d_cuboid çš„ä¸€ä¸ªå¯¹è±¡ï¼› 1 detect_cuboid_obj.detect_cuboid(raw_rgb_img,transToWolrd,raw_2d_objs,all_lines_raw," />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://wym.netlify.app/2019-02-22-cubeslam/" />
<meta property="article:published_time" content="2019-02-22T00:00:00+08:00" />
<meta property="article:modified_time" content="2019-02-22T00:00:00+08:00" />
<meta itemprop="name" content=" ğŸ˜œ Cube SLAM ä»£ç æ€»ç»“ï¼šå¦‚ä½•ä» 2D ç›®æ ‡æ£€æµ‹æ¢å¤ 3D ç‰©ä½“ä½å§¿">
<meta itemprop="description" content="æ³¨ï¼šğŸŒ Cube SLAM ç³»åˆ—è®ºæ–‡ï¼Œä»£ç æ³¨é‡Šã€æ€»ç»“æ±‡æ€» 0. å‡½æ•° 0.1. å‡½æ•°è°ƒç”¨ main_obj.cpp æ–‡ä»¶ä¸­ detect_cuboid_obj.detect_cuboid(); å¼€å§‹è¿›è¡Œç‰©ä½“ç«‹æ–¹ä½“ç»“æ„æ£€æµ‹ï¼› detect_cuboid_obj æ˜¯ç«‹æ–¹ä½“æ£€æµ‹ç±»ï¼ˆå®šä¹‰åœ¨ detect_3d_cuboid.h ä¸­ï¼‰ detect_3d_cuboid çš„ä¸€ä¸ªå¯¹è±¡ï¼› 1 detect_cuboid_obj.detect_cuboid(raw_rgb_img,transToWolrd,raw_2d_objs,all_lines_raw,">
<meta itemprop="datePublished" content="2019-02-22T00:00:00&#43;08:00" />
<meta itemprop="dateModified" content="2019-02-22T00:00:00&#43;08:00" />
<meta itemprop="wordCount" content="6912">



<meta itemprop="keywords" content="" /><meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content=" ğŸ˜œ Cube SLAM ä»£ç æ€»ç»“ï¼šå¦‚ä½•ä» 2D ç›®æ ‡æ£€æµ‹æ¢å¤ 3D ç‰©ä½“ä½å§¿"/>
<meta name="twitter:description" content="æ³¨ï¼šğŸŒ Cube SLAM ç³»åˆ—è®ºæ–‡ï¼Œä»£ç æ³¨é‡Šã€æ€»ç»“æ±‡æ€» 0. å‡½æ•° 0.1. å‡½æ•°è°ƒç”¨ main_obj.cpp æ–‡ä»¶ä¸­ detect_cuboid_obj.detect_cuboid(); å¼€å§‹è¿›è¡Œç‰©ä½“ç«‹æ–¹ä½“ç»“æ„æ£€æµ‹ï¼› detect_cuboid_obj æ˜¯ç«‹æ–¹ä½“æ£€æµ‹ç±»ï¼ˆå®šä¹‰åœ¨ detect_3d_cuboid.h ä¸­ï¼‰ detect_3d_cuboid çš„ä¸€ä¸ªå¯¹è±¡ï¼› 1 detect_cuboid_obj.detect_cuboid(raw_rgb_img,transToWolrd,raw_2d_objs,all_lines_raw,"/>

<!--[if lte IE 9]>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/classlist/1.1.20170427/classList.min.js"></script>
<![endif]-->

<!--[if lt IE 9]>
  <script src="https://cdn.jsdelivr.net/npm/html5shiv@3.7.3/dist/html5shiv.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/respond.js@1.4.2/dest/respond.min.js"></script>
<![endif]-->

</head>
<body>
  <div id="mobile-navbar" class="mobile-navbar">
  <div class="mobile-header-logo">
    <a href="/" class="logo">å°å´åŒå­¦çš„å´è¨€å´è¯­</a>
  </div>
  <div class="mobile-navbar-icon">
    <span></span>
    <span></span>
    <span></span>
  </div>
</div>
<nav id="mobile-menu" class="mobile-menu slideout-menu">
  <ul class="mobile-menu-list">
    <a href="/">
        <li class="mobile-menu-item">Home</li>
      </a><a href="/post/">
        <li class="mobile-menu-item">åšå®¢</li>
      </a><a href="/categories/">
        <li class="mobile-menu-item">åˆ†ç±»</li>
      </a><a href="/slam/">
        <li class="mobile-menu-item">SLAM</li>
      </a><a href="/about/">
        <li class="mobile-menu-item">About</li>
      </a><a href="/za/">
        <li class="mobile-menu-item"></li>
      </a>
  </ul>
</nav>
  <div class="container" id="mobile-panel">
    <header id="header" class="header">
        <div class="logo-wrapper">
  <a href="/" class="logo">å°å´åŒå­¦çš„å´è¨€å´è¯­</a>
</div>

<nav class="site-navbar">
  <ul id="menu" class="menu">
    <li class="menu-item">
        <a class="menu-item-link" href="/">Home</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/post/">åšå®¢</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/categories/">åˆ†ç±»</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/slam/">SLAM</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/about/">About</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/za/"></a>
      </li>
  </ul>
</nav>
    </header>

    <main id="main" class="main">
      <div class="content-wrapper">
        <div id="content" class="content">
          <article class="post">
    
    <header class="post-header">
      <h1 class="post-title"> ğŸ˜œ Cube SLAM ä»£ç æ€»ç»“ï¼šå¦‚ä½•ä» 2D ç›®æ ‡æ£€æµ‹æ¢å¤ 3D ç‰©ä½“ä½å§¿</h1>

      <div class="post-meta">
        <span class="post-time"> 2019-02-22 </span>
        <div class="post-category">
            <a href="/categories/slam/"> SLAM </a>
            <a href="/categories/code/"> code </a>
            <a href="/categories/cube-slam/"> cube slam </a>
            <a href="/categories/object-slam/"> object slam </a>
            </div>
          <span class="more-meta"> çº¦ 6912 å­— </span>
          <span class="more-meta"> é¢„è®¡é˜…è¯» 14 åˆ†é’Ÿ </span>
        
        
        
      </div>
    </header>

    <div class="post-toc" id="post-toc">
  <h2 class="post-toc-title">æ–‡ç« ç›®å½•</h2>
  <div class="post-toc-content">
    <nav id="TableOfContents">
  <ul>
    <li><a href="#0-å‡½æ•°">0. å‡½æ•°</a>
      <ul>
        <li><a href="#01-å‡½æ•°è°ƒç”¨">0.1. å‡½æ•°è°ƒç”¨</a></li>
        <li><a href="#02-å‡½æ•°å®šä¹‰">0.2. å‡½æ•°å®šä¹‰</a></li>
      </ul>
    </li>
    <li><a href="#1-çº¿æ®µä¿¡æ¯æ’åº">1. çº¿æ®µä¿¡æ¯æ’åº</a></li>
    <li><a href="#2-ground-wall-è¾¹ç•Œçº¿">2. ground-wall è¾¹ç•Œçº¿</a></li>
    <li><a href="#3-2d-æ£€æµ‹æ¡†é«˜åº¦é‡‡æ ·">3. 2D æ£€æµ‹æ¡†é«˜åº¦é‡‡æ ·</a>
      <ul>
        <li><a href="#31-yolo-2d-æ£€æµ‹æ¡†åŸå§‹ä¿¡æ¯">3.1 YOLO 2D æ£€æµ‹æ¡†åŸå§‹ä¿¡æ¯</a></li>
        <li><a href="#32-æ‰©å¤§è¾¹ç•Œæ¡†å¤§å°">3.2 æ‰©å¤§è¾¹ç•Œæ¡†å¤§å°</a></li>
        <li><a href="#33-è¾¹ç•Œè·ç¦»å®½åº¦">3.3 è¾¹ç•Œè·ç¦»å®½åº¦</a></li>
      </ul>
    </li>
    <li><a href="#4-ç‰©ä½“åèˆªè§’-yaw-é‡‡æ ·">4. ç‰©ä½“åèˆªè§’ yaw é‡‡æ ·</a></li>
    <li><a href="#5-ä¸Šè¾¹ç¼˜ç‚¹é‡‡æ ·">5. ä¸Šè¾¹ç¼˜ç‚¹é‡‡æ ·</a></li>
    <li><a href="#6-çº¿æ®µçš„å¤„ç†">6. çº¿æ®µçš„å¤„ç†</a>
      <ul>
        <li><a href="#61-ä¿ç•™åœ¨æ‰©å¤§åè¾¹ç•Œå†…çš„çº¿æ®µ">6.1 ä¿ç•™åœ¨æ‰©å¤§åè¾¹ç•Œå†…çš„çº¿æ®µ</a></li>
        <li><a href="#62-çº¿æ®µåˆå¹¶ä¸å‰”é™¤">6.2 çº¿æ®µåˆå¹¶ä¸å‰”é™¤</a></li>
      </ul>
    </li>
    <li><a href="#7-çº¿æ®µè¾¹ç¼˜æ£€æµ‹è·ç¦»å˜æ¢">7. çº¿æ®µã€è¾¹ç¼˜æ£€æµ‹ã€è·ç¦»å˜æ¢</a>
      <ul>
        <li><a href="#71-è®¡ç®—ç­›é€‰ä¹‹åçš„çº¿æ®µè§’åº¦å’Œä¸­ç‚¹">7.1 è®¡ç®—ç­›é€‰ä¹‹åçš„çº¿æ®µè§’åº¦å’Œä¸­ç‚¹</a></li>
        <li><a href="#72-canny-è¾¹ç¼˜æ£€æµ‹">7.2 Canny è¾¹ç¼˜æ£€æµ‹</a></li>
        <li><a href="#73-æ„å»ºè·ç¦»å›¾">7.3 æ„å»ºè·ç¦»å›¾</a></li>
      </ul>
    </li>
    <li><a href="#8-ç«‹æ–¹ä½“ææ¡ˆç”Ÿæˆ">8. ç«‹æ–¹ä½“ææ¡ˆç”Ÿæˆ</a>
      <ul>
        <li><a href="#81-é‡‡æ ·ç›¸æœºçš„ç¿»æ»šè§’-roll-å’Œä¿¯ä»°è§’-pitch">8.1 é‡‡æ ·ç›¸æœºçš„ç¿»æ»šè§’ roll å’Œä¿¯ä»°è§’ pitch</a></li>
        <li><a href="#82-è®¡ç®—ä¸‰ä¸ªæ¶ˆå¤±ç‚¹">8.2 è®¡ç®—ä¸‰ä¸ªæ¶ˆå¤±ç‚¹</a></li>
        <li><a href="#83-å¯»æ‰¾å½¢æˆæ¶ˆå¤±ç‚¹çš„è¾¹">8.3 å¯»æ‰¾å½¢æˆæ¶ˆå¤±ç‚¹çš„è¾¹</a></li>
        <li><a href="#84-è®¡ç®—ç‰©ä½“-8-ä¸ªç‚¹çš„-2dåæ ‡">8.4 è®¡ç®—ç‰©ä½“ 8 ä¸ªç‚¹çš„ 2Dåæ ‡</a></li>
        <li><a href="#85-è¯¯å·®è®¡ç®—ä¸€">8.5 è¯¯å·®è®¡ç®—ï¼ˆä¸€ï¼‰</a></li>
        <li><a href="#86-ç”Ÿæˆ-3d-ç«‹æ–¹ä½“ææ¡ˆ">8.6 ç”Ÿæˆ 3D ç«‹æ–¹ä½“ææ¡ˆ</a></li>
        <li><a href="#87-è¯¯å·®è®¡ç®—äºŒ">8.7 è¯¯å·®è®¡ç®—ï¼ˆäºŒï¼‰</a></li>
        <li><a href="#88-ç»˜åˆ¶ææ¡ˆ">8.8 ç»˜åˆ¶ææ¡ˆ</a></li>
      </ul>
    </li>
  </ul>
</nav>
  </div>
</div>
    <div class="post-content">
      <p>æ³¨ï¼š<a href="https://www.wuxiaolang.cn/slam/"><!-- raw HTML omitted --><strong>ğŸŒ Cube SLAM ç³»åˆ—è®ºæ–‡ï¼Œä»£ç æ³¨é‡Šã€æ€»ç»“æ±‡æ€»</strong><!-- raw HTML omitted --></a></p>
<h2 id="0-å‡½æ•°">0. å‡½æ•°</h2>
<h3 id="01-å‡½æ•°è°ƒç”¨">0.1. å‡½æ•°è°ƒç”¨</h3>
<ul>
<li><code>main_obj.cpp</code> æ–‡ä»¶ä¸­ <code>detect_cuboid_obj.detect_cuboid();</code> <strong>å¼€å§‹è¿›è¡Œç‰©ä½“ç«‹æ–¹ä½“ç»“æ„æ£€æµ‹</strong>ï¼›
<ul>
<li><code>detect_cuboid_obj</code> æ˜¯ç«‹æ–¹ä½“æ£€æµ‹ç±»ï¼ˆå®šä¹‰åœ¨ <code>detect_3d_cuboid.h</code> ä¸­ï¼‰ <code>detect_3d_cuboid</code> çš„ä¸€ä¸ªå¯¹è±¡ï¼›</li>
</ul>
</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-cpp" data-lang="cpp"><span class="n">detect_cuboid_obj</span><span class="p">.</span><span class="n">detect_cuboid</span><span class="p">(</span><span class="n">raw_rgb_img</span><span class="p">,</span><span class="n">transToWolrd</span><span class="p">,</span><span class="n">raw_2d_objs</span><span class="p">,</span><span class="n">all_lines_raw</span><span class="p">,</span> <span class="n">frames_cuboids</span><span class="p">);</span>
</code></pre></td></tr></table>
</div>
</div><h3 id="02-å‡½æ•°å®šä¹‰">0.2. å‡½æ•°å®šä¹‰</h3>
<ul>
<li><code>detect_cuboid()</code> å‡½æ•°å®šä¹‰åœ¨ <code>box_proposal_detail.cpp</code> æ–‡ä»¶ä¸­ã€‚</li>
<li><strong>è¾“å…¥</strong>ï¼šåŸå§‹å›¾åƒ <code>rgb_img</code> ï¼› ç›¸æœºä½å§¿ <code>transToWolrd</code> ï¼› 2D æ£€æµ‹æ¡†ä¿¡æ¯ <code>obj_bbox_coors</code> ï¼› çº¿æ£€æµ‹çš„è¾¹ç¼˜çº¿ä¿¡æ¯ <code>all_lines_raw</code> ï¼›</li>
<li><strong>è¾“å‡º</strong>ï¼šç«‹æ–¹ä½“ææ¡ˆï¼š<code>std::vector&lt;ObjectSet&gt;&amp; all_object_cuboids</code> ï¼ˆææ¡ˆä¸ªæ•°ç­‰äºå›¾åƒå¸§æ•°ï¼‰</li>
</ul>
<hr>
<h2 id="1-çº¿æ®µä¿¡æ¯æ’åº">1. çº¿æ®µä¿¡æ¯æ’åº</h2>
<ul>
<li><strong>é¦–å…ˆéœ€è¦ä¿è¯ä½œä¸ºè¾“å…¥çš„çº¿æ®µ</strong>ä¿¡æ¯çŸ©é˜µ <code>MatrixXd all_lines_raw</code> ä¸­å­˜å‚¨çš„æ‰€æœ‰çº¿æ®µçš„<strong>ä¸¤ä¸ªç«¯ç‚¹æ˜¯ä»å·¦åˆ°å³æ’åº</strong>çš„ï¼ˆ<code>x</code>åæ ‡ï¼‰ï¼›</li>
<li><code>align_left_right_edges()</code> å‡½æ•°åœ¨ <code>object_3d_util.cpp</code> æ–‡ä»¶ä¸­ï¼›</li>
<li>æ¯”å¦‚ï¼Œæ’åºå‰åï¼š</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-fallback" data-lang="fallback"># all_lines_raw æ’åºå‰ï¼š
    x_1         y_1        x_2        y_2      
   33.6847    18.1416    25.6146   0.173099
   36.4537 -0.0483192    38.5934    20.0433
    65.885  0.0112345    68.7188    29.0275
   103.954    37.9624    102.454 -0.0179376
   78.8074    48.5287    102.018    39.0428
   532.903    149.891    363.809    12.2352
   475.029    337.319    532.423    152.131
   314.382    391.152    473.163    338.492
   229.763    193.524    312.705    389.125
   210.468    25.1893    231.075    191.991
   307.014    188.992    214.057    32.9661
# all_lines_raw æ’åºåï¼š
   25.6146   0.173099    33.6847    18.1416
   36.4537 -0.0483192    38.5934    20.0433
    65.885  0.0112345    68.7188    29.0275
   102.454 -0.0179376    103.954    37.9624
   78.8074    48.5287    102.018    39.0428
   363.809    12.2352    532.903    149.891
   475.029    337.319    532.423    152.131
   314.382    391.152    473.163    338.492
   229.763    193.524    312.705    389.125
   210.468    25.1893    231.075    191.991
   214.057    32.9661    307.014    188.992
</code></pre></td></tr></table>
</div>
</div><ul>
<li>åœ¨åŸå›¾ä¸Šç»˜åˆ¶æ£€æµ‹åˆ°çš„çº¿æ®µï¼š<code>plot_image_with_edges()</code> å‡½æ•°
<img src="https://github.com/wuxiaolang/Cube_SLAM_wu/blob/master/wu/pic/Raw_detected_Edges.png?raw=true" alt="Raw_detected_Edges"></li>
</ul>
<hr>
<h2 id="2-ground-wall-è¾¹ç•Œçº¿">2. ground-wall è¾¹ç•Œçº¿</h2>
<ul>
<li>ç”¨ <code>(0,0,1,0)</code> è¡¨ç¤ºåœ°å¹³é¢ <code>ground_plane_world</code>
<ul>
<li>å¹³é¢çš„è¡¨ç¤ºï¼šä¸€ä¸ª<strong>å¹³é¢å¯ä»¥ç”¨ä¸€ä¸ªé½æ¬¡å‘é‡è¡¨ç¤º</strong>ï¼š$\pi = \left ( \pi _{1},\pi _{2},\pi _{3},\pi _{4} \right )^{T} = \left ( n^{T},d \right )^{T}$ ï¼Œå…¶ä¸­ n æ˜¯å¹³é¢çš„æ³•å‘é‡ï¼Œd æ˜¯å®ƒåˆ°åŸç‚¹çš„è·ç¦»ï¼›</li>
</ul>
</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-fallback" data-lang="fallback">Vector4d ground_plane_world(0,0,1,0);
</code></pre></td></tr></table>
</div>
</div><ul>
<li>è®¡ç®—ä¼ æ„Ÿå™¨ï¼ˆç›¸æœºï¼‰çš„å¹³é¢ <code>ground_plane_sensor</code></li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-fallback" data-lang="fallback">Vector4d ground_plane_sensor = cam_pose.transToWolrd.transpose() * ground_plane_world;
</code></pre></td></tr></table>
</div>
</div><ul>
<li><strong>ç›¸æœºç³»ä¸­çš„å¹³é¢</strong>ä¸ä¸–ç•Œç³»å¹³é¢çš„è½¬æ¢å…³ç³»ä¸ºï¼š
$$\pi_{w}=\left(T_{w, c}^{-}\right)^{T} \cdot \pi_{c}$$</li>
</ul>
<hr>
<h2 id="3-2d-æ£€æµ‹æ¡†é«˜åº¦é‡‡æ ·">3. 2D æ£€æµ‹æ¡†é«˜åº¦é‡‡æ ·</h2>
<h3 id="31-yolo-2d-æ£€æµ‹æ¡†åŸå§‹ä¿¡æ¯">3.1 YOLO 2D æ£€æµ‹æ¡†åŸå§‹ä¿¡æ¯</h3>
<ul>
<li>å·¦ä¸Šè§’åæ ‡ï¼š<code>(left_x_raw, top_y_raw)</code></li>
<li>å®½ï¼š<code>obj_width_raw</code></li>
<li>é«˜ï¼š<code>obj_height_raw</code></li>
<li>å³ä¸‹è§’åæ ‡ï¼š<code>(right_x_raw, down_y_raw)</code></li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-fallback" data-lang="fallback">obj_bbox_coorsï¼š
# x1    y1       å®½      é«˜
175	24	385	373	0.42
201	40	341	386	0.32
208	54	351	371	0.54
</code></pre></td></tr></table>
</div>
</div><h3 id="32-æ‰©å¤§è¾¹ç•Œæ¡†å¤§å°">3.2 æ‰©å¤§è¾¹ç•Œæ¡†å¤§å°</h3>
<ul>
<li>2D ç›®æ ‡æ£€æµ‹çš„æ£€æµ‹æ¡†å¯èƒ½ä¸å‡†ç¡®ï¼Œæ˜¯å¦å¯¹æ£€æµ‹æ¡†çš„é«˜åº¦è¿›è¡Œé‡‡æ ·ï¼š<code>std::vector&lt;int&gt; down_expand_sample_all;</code>
<ul>
<li>ä¸é‡‡æ ·çš„è¯ï¼š <code>down_expand_sample_all = 0</code>ï¼›</li>
<li>å¦‚æœé‡‡æ ·é«˜åº¦ï¼š <code>down_expand_sample_all = 0ï¼Œ10ï¼Œ20;</code></li>
<li>å¼€å…³ <code>whether_sample_bbox_height</code> åœ¨ <code>detect_3d_cuboid.h</code> å’Œ <code>main_obj.cpp</code> ä¸­ï¼›</li>
</ul>
</li>
<li>äº‹å®ä¸Šï¼Œå¼€å¯äº†é«˜åº¦é‡‡æ ·ä¹‹åå¥½åƒæ•ˆæœæ›´å·®äº†ï¼Ÿ</li>
<li><code>down_expand_sample_all</code> çš„ size æ˜¯éœ€è¦è®¡ç®—çš„æ¬¡æ•°ï¼Œä¸é‡‡æ ·æ—¶è®¡ç®—ä¸€æ¬¡ï¼Œé‡‡æ · 10 åƒç´ å†è®¡ç®—ä¸€æ¬¡ï¼Œé‡‡æ · 20 åƒç´ å†è®¡ç®—ä¸€æ¬¡ã€‚</li>
</ul>
<h3 id="33-è¾¹ç•Œè·ç¦»å®½åº¦">3.3 è¾¹ç•Œè·ç¦»å®½åº¦</h3>
<ul>
<li>å¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œé»„è‰²çš„æ¡†æ˜¯ YOLO åŸå§‹çš„ 2D æ£€æµ‹æ¡†ï¼Œå…¶ä»–é¢œè‰²çš„æ¡†æ˜¯æ‹“å®½ 20 åƒç´ çš„è¾¹ç•Œæ¡†ï¼›
<ul>
<li>è“è‰²ã€ç»¿è‰²å’Œçº¢è‰²çš„æ£€æµ‹æ¡†åˆ†åˆ«æ˜¯é‡‡æ ·äº†é«˜åº¦ä¹‹åï¼Œä¹Ÿå°±æ˜¯é«˜åº¦é‡‡æ ·åªå¾€ y ä¸‹æ–¹è¿›è¡Œé‡‡æ ·äº†ã€‚
<img src="https://github.com/wuxiaolang/Cube_SLAM_wu/blob/master/wu/pic/extend_box.png?raw=true" alt="extend_box"></li>
</ul>
</li>
</ul>
<hr>
<h2 id="4-ç‰©ä½“åèˆªè§’-yaw-é‡‡æ ·">4. ç‰©ä½“åèˆªè§’ yaw é‡‡æ ·</h2>
<ul>
<li>ç‰©ä½“çš„åèˆªè§’ç›´æ¥<strong>åˆå§‹åŒ–</strong>ä¸ºé¢å‘ç›¸æœºï¼Œä¸å…‰è½´å¯¹é½</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-fallback" data-lang="fallback">double yaw_init = cam_pose.camera_yaw - 90.0 / 180.0 * M_PI;
</code></pre></td></tr></table>
</div>
</div><ul>
<li>ç„¶åä»¥åˆå§‹åŒ–çš„ yaw è§’ä¸ºä¸­å¿ƒçš„ - 45Â° åˆ° + 45Â° çš„ 90 Â° èŒƒå›´å†…ï¼Œæ¯éš” 6 Â° é‡‡æ ·ä¸€ä¸ªå€¼ï¼Œ<strong>é‡‡æ ·å¾—åˆ° 15 ä¸ªåèˆªè§’</strong>ã€‚</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-fallback" data-lang="fallback">std::vector&lt;double&gt; obj_yaw_samples; 
// BRIEF linespace()å‡½æ•°ä» a åˆ° b ä»¥æ­¥é•¿ c äº§ç”Ÿé‡‡æ ·çš„ d.
linespace&lt;double&gt;(yaw_init - 45.0/180.0*M_PI, yaw_init + 45.0/180.0*M_PI, 6.0/180.0*M_PI, obj_yaw_samples);
</code></pre></td></tr></table>
</div>
</div><hr>
<h2 id="5-ä¸Šè¾¹ç¼˜ç‚¹é‡‡æ ·">5. ä¸Šè¾¹ç¼˜ç‚¹é‡‡æ ·</h2>
<ul>
<li>ä¸ºç¡®å®šç‰©ä½“çš„â€œé¡¶ç‚¹â€éœ€è¦ä»åŸå§‹è¾¹ç•Œæ¡†çš„æœ€å·¦è¾¹ <code>left_x_raw+5</code> åˆ°æœ€å³è¾¹ <code>right_x_raw-5</code> æ¯éš” <code>top_sample_resolution</code>ï¼ˆ20åƒç´ ï¼‰çš„è·ç¦»é‡‡æ ·ä¸€ä¸ªç‚¹ <code>top_x_samples[i]</code>.</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-fallback" data-lang="fallback">int top_sample_resolution = round(min(20,obj_width_raw/10 )); //  20 pixels
std::vector&lt;int&gt; top_x_samples; 
linespace&lt;int&gt;(left_x_raw+5, right_x_raw-5, top_sample_resolution, top_x_samples);
</code></pre></td></tr></table>
</div>
</div><ul>
<li>ä¸ºç¡®å®šç‰©ä½“çš„é¡¶éƒ¨ï¼Œ<strong>æä¾›è‡³å°‘ 10 ä¸ªé‡‡æ ·ç‚¹ï¼ˆåæœŸé€šè¿‡æœ€å°è¯¯å·®å¾—åˆ°æœ€åˆé€‚çš„ç‚¹ï¼‰</strong>ï¼Œå¯¹äºè¶Šå°çš„ç‰©ä½“éœ€è¦è¶Šç²¾ç»†çš„é‡‡æ ·ã€‚ä¸Šè¾¹ç¼˜é‡‡æ ·ç‚¹å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š   <br>
<img src="https://github.com/wuxiaolang/Cube_SLAM_wu/blob/master/wu/pic/top_sample.png?raw=true" alt="top_sample"></li>
<li><!-- raw HTML omitted -->**ç–‘é—®ï¼šä¸ºä»€ä¹ˆåœ¨åŸå§‹æ£€æµ‹æ¡†çš„é¡¶éƒ¨é‡‡æ ·ï¼Ÿä¸åœ¨æ‹“å®½è¾¹ç•Œä¹‹åçš„é¡¶éƒ¨é‡‡æ ·å‘¢ï¼Ÿæ•ˆæœæ˜¯å¦ä¼šæ›´å¥½ã€‚**<!-- raw HTML omitted --></li>
</ul>
<hr>
<h2 id="6-çº¿æ®µçš„å¤„ç†">6. çº¿æ®µçš„å¤„ç†</h2>
<h3 id="61-ä¿ç•™åœ¨æ‰©å¤§åè¾¹ç•Œå†…çš„çº¿æ®µ">6.1 ä¿ç•™åœ¨æ‰©å¤§åè¾¹ç•Œå†…çš„çº¿æ®µ</h3>
<ul>
<li>çº¿æ£€æµ‹å¾—åˆ°çš„æ‰€æœ‰çº¿æ®µï¼š<code>all_lines_raw</code>ï¼Œç­›é€‰ä¹‹ååœ¨èŒƒå›´å†…çš„çº¿æ®µï¼š<code>all_lines_inside_object</code>ï¼›</li>
<li><code>check_inside_box()</code> å‡½æ•°æ£€æµ‹çº¿æ®µæ˜¯å¦åœ¨çŸ©å½¢æ¡†å†…ï¼Œä½äº <code>object_3d_util.cpp</code> æ–‡ä»¶ä¸­ï¼›</li>
<li>è¦æ±‚çº¿æ®µçš„ä¸¤ä¸ªç«¯ç‚¹éœ€è¦åŒæ—¶éƒ½åœ¨æ¡†å†…ï¼ˆ<!-- raw HTML omitted -->æ˜¯å¦å¯æ”¹è¿›å‘¢<!-- raw HTML omitted -->ï¼‰</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-fallback" data-lang="fallback">for (int edge_id = 0; edge_id &lt; all_lines_raw.rows(); edge_id++)
// åˆ¤æ–­ all_lines_raw çŸ©é˜µä¸­ç¬¬ edge_id çº¿æ®µçš„ä¸€ä¸ªç«¯ç‚¹.head&lt;2&gt; æ˜¯å¦åœ¨åŒºåŸŸä¸­.
if (check_inside_box(all_lines_raw.row(edge_id).head&lt;2&gt;(), expan_distmap_lefttop, expan_distmap_rightbottom ))
// åˆ¤æ–­ all_lines_raw çŸ©é˜µä¸­ç¬¬ edge_id çº¿æ®µçš„å¦ä¸€ä¸ªç«¯ç‚¹.tail&lt;2&gt; æ˜¯å¦åœ¨åŒºåŸŸä¸­.
if (check_inside_box(all_lines_raw.row(edge_id).tail&lt;2&gt;(),expan_distmap_lefttop, expan_distmap_rightbottom ))
{
	// å­˜å‚¨æ‰€æœ‰åœ¨æ‰©å¤§åçš„è¾¹ç•Œæ¡†å†…çš„çº¿æ®µ.
	all_lines_inside_object.row(inside_obj_edge_num) = all_lines_raw.row(edge_id);
	inside_obj_edge_num++;
}
</code></pre></td></tr></table>
</div>
</div><h3 id="62-çº¿æ®µåˆå¹¶ä¸å‰”é™¤">6.2 çº¿æ®µåˆå¹¶ä¸å‰”é™¤</h3>
<ul>
<li>çŸ­è¾¹åˆå¹¶ä¸å‰”é™¤åœ¨ <code>merge_break_lines()</code> å‡½æ•°ä¸­å®ç°ï¼Œä½äº <code>object_3d_util.cpp</code> æ–‡ä»¶ä¸­ï¼›</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-fallback" data-lang="fallback">void merge_break_lines( const MatrixXd&amp; all_lines,  /*è¾“å…¥çš„æ‰€æœ‰åœ¨çŸ©é˜µæ¡†å†…çš„çº¿æ®µçŸ©é˜µ*/
                        MatrixXd&amp; merge_lines_out,  /*è¾“å‡ºçš„åˆå¹¶åçš„çº¿æ®µçŸ©é˜µ*/
                        double pre_merge_dist_thre, /*ä¸¤æ¡çº¿æ®µä¹‹é—´çš„è·ç¦»é˜ˆå€¼ 20 åƒç´ */
		        double pre_merge_angle_thre_degree, /*è§’åº¦é˜ˆå€¼ 5Â°*/
                        double edge_length_threshold)       /*é•¿åº¦é˜ˆå€¼ 30*/
</code></pre></td></tr></table>
</div>
</div><h4 id="621-çº¿æ®µåˆå¹¶">6.2.1 çº¿æ®µåˆå¹¶</h4>
<ul>
<li><strong>é¦–å…ˆè¦æ±‚ä¸¤æ¡çº¿æ®µçš„è§’åº¦è¯¯å·®å°äº 5 Â°</strong>ï¼›
<ul>
<li><code>atan2_vector()</code> å‡½æ•°æ ¹æ®çº¿æ®µçš„æ°´å¹³å’Œç«–ç›´æŠ•å½±<strong>è®¡ç®—çº¿æ®µçš„è§’åº¦</strong> [-90, 90] èŒƒå›´å†…ï¼›</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-fallback" data-lang="fallback">// BRIEF æ ¹æ®çº¿æ®µçš„ æ°´å¹³å’Œç«–ç›´é•¿åº¦x_vec y_vec è®¡ç®—å‡ºè§’åº¦ all_angles
void atan2_vector(const VectorXd&amp; y_vec, const VectorXd&amp; x_vec, VectorXd&amp; all_angles)
{
    all_angles.resize(y_vec.rows());
    for (int i=0;i&lt;y_vec.rows();i++)
        all_angles(i)=std::atan2(y_vec(i),x_vec(i));  // don&#39;t need normalize_to_pi, because my edges is from left to right, always [-90 90]
}
</code></pre></td></tr></table>
</div>
</div><ul>
<li><strong>è®¡ç®—ä¸¤æ¡çº¿æ®µçš„è§’åº¦å·®</strong>ï¼Œå¹¶ä¿è¯è§’åº¦å·®å°äºé˜ˆå€¼ <code>pre_merge_angle_thre</code> ï¼ˆ5 Â°ï¼‰</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-fallback" data-lang="fallback">// ç›¸é‚»ä¸¤æ¡é€‰æ®µçš„è§’åº¦å·® angle_diff.
double diff = std::abs(all_angles(seg1) - all_angles(seg2));
double angle_diff = std::min(diff, M_PI - diff);
</code></pre></td></tr></table>
</div>
</div></li>
<li><strong>ç„¶åè¦æ±‚ä¸¤æ¡çº¿æ®µçš„è·ç¦»å·®å°äº 20 åƒç´ </strong>ï¼›
<ul>
<li>è®¡ç®—ä¸¤æ¡çº¿æ®µçš„è·ç¦»ï¼š</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-fallback" data-lang="fallback">// dist_1ed_to_2ï¼šçº¿1å°¾åˆ°çº¿2å¤´çš„è·ç¦»ï¼›
// dist_2ed_to_1ï¼šçº¿2å°¾åˆ°çº¿1å¤´çš„è·ç¦»ï¼›
double dist_1ed_to_2 = (merge_lines_out.row(seg1).tail(2) - merge_lines_out.row(seg2).head(2)).norm();
double dist_2ed_to_1 = (merge_lines_out.row(seg2).tail(2) - merge_lines_out.row(seg1).head(2)).norm();
</code></pre></td></tr></table>
</div>
</div><ul>
<li>è¦æ±‚â€œçº¿1å°¾åˆ°çº¿2å¤´çš„è·ç¦»â€<strong>æˆ–</strong>â€œçº¿2å°¾åˆ°çº¿1å¤´çš„è·ç¦»â€å°äºé˜ˆå€¼ <code>pre_merge_dist_thre</code>ï¼ˆ20åƒç´ ï¼‰</li>
</ul>
</li>
<li>åŒæ—¶æ»¡è¶³ä»¥ä¸Šä¸¤ä¸ªæ¡ä»¶çš„<strong>ä¸¤æ¡çº¿æ®µè¿›è¡Œåˆå¹¶</strong></li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-fallback" data-lang="fallback">Vector2d merge_start, merge_end;
if (merge_lines_out(seg1,0) &lt; merge_lines_out(seg2,0))
     merge_start = merge_lines_out.row(seg1).head(2);
else
     merge_start = merge_lines_out.row(seg2).head(2);
if (merge_lines_out(seg1,2) &gt; merge_lines_out(seg2,2))
     merge_end = merge_lines_out.row(seg1).tail(2);
else
     merge_end = merge_lines_out.row(seg2).tail(2);
// èåˆä¹‹åçš„æ–°çš„çº¿æ®µçš„è§’åº¦ merged_angle.
double merged_angle = std::atan2(merge_end(1)-merge_start(1),merge_end(0)-merge_start(0));
</code></pre></td></tr></table>
</div>
</div><p><img src="https://github.com/wuxiaolang/Cube_SLAM_wu/blob/master/wu/pic/merge_line.png?raw=true" alt="merge_line"></p>
<h4 id="622-çº¿æ®µå‰”é™¤">6.2.2 çº¿æ®µå‰”é™¤</h4>
<ul>
<li>è®¡ç®—æ¯æ¡çº¿æ®µçš„é•¿åº¦ï¼Œå¹¶è¦æ±‚å¤§äºé•¿åº¦é˜ˆå€¼ <code>edge_length_threshold</code> ï¼ˆ30 åƒç´ ï¼‰</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-fallback" data-lang="fallback">// é‡æ–°è®¡ç®—åˆå¹¶ä¹‹åçš„çº¿æ®µå‘é‡ï¼šæ‰€æœ‰çº¿æ®µçš„å³è¾¹ç‚¹çš„åæ ‡ - å·¦è¾¹ç‚¹çš„åæ ‡ = æ¯æ¡çº¿æ®µçš„æ°´å¹³xé•¿åº¦å’Œç«–ç›´yé•¿åº¦.
MatrixXd line_vectors = merge_lines_out.topRightCorner(total_line_number,2) - merge_lines_out.topLeftCorner(total_line_number,2);
// @PARAM line_lengths å­˜å‚¨æ¯æ¡çº¿æ®µçš„é•¿åº¦
VectorXd line_lengths = line_vectors.rowwise().norm();
</code></pre></td></tr></table>
</div>
</div><ul>
<li>æœ€ç»ˆç»è¿‡çº¿æ®µåˆå¹¶ä¸ç­›é€‰ä¹‹åçš„æ•ˆæœ   <br>
<img src="https://github.com/wuxiaolang/Cube_SLAM_wu/blob/master/wu/pic/merge_lines_img.png?raw=true" alt="merge_lines_img"></li>
</ul>
<hr>
<h2 id="7-çº¿æ®µè¾¹ç¼˜æ£€æµ‹è·ç¦»å˜æ¢">7. çº¿æ®µã€è¾¹ç¼˜æ£€æµ‹ã€è·ç¦»å˜æ¢</h2>
<h3 id="71-è®¡ç®—ç­›é€‰ä¹‹åçš„çº¿æ®µè§’åº¦å’Œä¸­ç‚¹">7.1 è®¡ç®—ç­›é€‰ä¹‹åçš„çº¿æ®µè§’åº¦å’Œä¸­ç‚¹</h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-fallback" data-lang="fallback">// è®¡ç®—æ¯æ¡è¾¹ç¼˜çº¿æ®µçš„è§’åº¦å’Œä¸­ç‚¹.
// @PARAM lines_inobj_angles	çº¿æ®µè§’åº¦.
// @PARAM edge_mid_pts			çº¿æ®µçš„ä¸­ç‚¹.
VectorXd lines_inobj_angles(all_lines_merge_inobj.rows());
MatrixXd edge_mid_pts(all_lines_merge_inobj.rows(),2);
for (int i=0; i &lt; all_lines_merge_inobj.rows(); i++)
{
	lines_inobj_angles(i) = std::atan2(all_lines_merge_inobj(i,3)-all_lines_merge_inobj(i,1), all_lines_merge_inobj(i,2)-all_lines_merge_inobj(i,0));   // [-pi/2 -pi/2]
	edge_mid_pts.row(i).head&lt;2&gt;() = (all_lines_merge_inobj.row(i).head&lt;2&gt;()+all_lines_merge_inobj.row(i).tail&lt;2&gt;())/2;
}
</code></pre></td></tr></table>
</div>
</div><h3 id="72-canny-è¾¹ç¼˜æ£€æµ‹">7.2 Canny è¾¹ç¼˜æ£€æµ‹</h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-fallback" data-lang="fallback">cv::Mat im_canny; 
// @PARAM		object_bbox		æ‰©å¤§åçš„æ£€æµ‹æ¡†.
cv::Rect object_bbox = cv::Rect(left_x_expan_distmap, top_y_expan_distmap, width_expan_distmap, height_expan_distmap);
cv::Canny(gray_img(object_bbox), im_canny, 80, 200); // low thre, high thre    im_canny 0 or 255   [80 200  40 100]
</code></pre></td></tr></table>
</div>
</div><h3 id="73-æ„å»ºè·ç¦»å›¾">7.3 æ„å»ºè·ç¦»å›¾</h3>
<ul>
<li>2D é•¿æ–¹ä½“è¾¹ç¼˜åº”ä¸å®é™…å›¾åƒçš„è¾¹ç¼˜åŒ¹é…ã€‚åˆ©ç”¨ Canny è¾¹ç¼˜æ£€æµ‹æ–¹æ³•æ„å»ºè·ç¦»å›¾ï¼Œç„¶åå†é•¿æ–¹ä½“è¾¹ç¼˜å€’è§’è·ç¦»ï¼ˆChamfer distanceï¼‰è¿›è¡Œç´¯åŠ æ±‚å’Œï¼Œå†é€šè¿‡ 2D æ¡†çš„å¤§å°è¿›è¡Œå½’ä¸€åŒ–ã€‚</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-fallback" data-lang="fallback">cv::Mat dist_map; 
cv::distanceTransform(255 - im_canny, dist_map, CV_DIST_L2, 3); // dist_map is float datatype
</code></pre></td></tr></table>
</div>
</div><p><img src="https://github.com/wuxiaolang/Cube_SLAM_wu/blob/master/wu/pic/canny_dist_map.png?raw=true" alt="canny_dist_map"></p>
<hr>
<h2 id="8-ç«‹æ–¹ä½“ææ¡ˆç”Ÿæˆ">8. ç«‹æ–¹ä½“ææ¡ˆç”Ÿæˆ</h2>
<h3 id="81-é‡‡æ ·ç›¸æœºçš„ç¿»æ»šè§’-roll-å’Œä¿¯ä»°è§’-pitch">8.1 é‡‡æ ·ç›¸æœºçš„ç¿»æ»šè§’ roll å’Œä¿¯ä»°è§’ pitch</h3>
<ul>
<li>ä»¥ç›¸æœºåè§’ä¸ºä¸­å¿ƒçš„<strong>æ­£è´Ÿ 6 Â° èŒƒå›´å†…ï¼Œæ¯éš” 3 Â° é‡‡æ ·ä¸€ä¸ªå€¼</strong>ï¼ˆå¦‚æœä¸é‡‡æ ·çš„è¯å°±ç›´æ¥ä½¿ç”¨ç›¸æœºçš„ roll å’Œ pitch è§’ï¼‰ï¼Œä¹Ÿå°±æ˜¯åˆ†åˆ«é‡‡æ ·äº† 5 ä¸ªè§’åº¦ï¼›</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-fallback" data-lang="fallback">std::vector&lt;double&gt; cam_roll_samples; 
std::vector&lt;double&gt; cam_pitch_samples;
if (whether_sample_cam_roll_pitch)
{
	linespace&lt;double&gt;(cam_pose_raw.euler_angle(0)-6.0/180.0*M_PI, cam_pose_raw.euler_angle(0)+6.0/180.0*M_PI, 3.0/180.0*M_PI, cam_roll_samples);
	linespace&lt;double&gt;(cam_pose_raw.euler_angle(1)-6.0/180.0*M_PI, cam_pose_raw.euler_angle(1)+6.0/180.0*M_PI, 3.0/180.0*M_PI, cam_pitch_samples);
}
else
{
	cam_roll_samples.push_back(cam_pose_raw.euler_angle(0));
	cam_pitch_samples.push_back(cam_pose_raw.euler_angle(1));
}
</code></pre></td></tr></table>
</div>
</div><ul>
<li>åŒæ—¶ï¼Œä¿å­˜<strong>æ–°çš„ç›¸æœºä½å§¿</strong>ï¼Œè®¡ç®—æ–°çš„<strong>ç›¸æœºå¹³é¢</strong></li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-fallback" data-lang="fallback">// å°†å½“å‰è§’åº¦å€¼è½¬æ¢æˆæ—‹è½¬çŸ©é˜µ. 
// NOTE è¿™é‡Œyawä¸ºä»€ä¹ˆä¸ç”¨é‡‡æ ·çš„å€¼è€Œç”¨ç›¸æœºçš„å€¼ï¼Ÿï¼šyaw é‡‡æ ·æ˜¯çœŸå¯¹ç‰©ä½“çš„ï¼Œå¹¶æ²¡æœ‰å¯¹ç›¸æœºçš„ yaw å€¼è¿›è¡Œé‡‡æ ·ã€‚
transToWolrd_new.topLeftCorner&lt;3,3&gt;() = euler_zyx_to_rot&lt;double&gt;(cam_roll_samples[cam_roll_id], cam_pitch_samples[cam_pitch_id], cam_pose_raw.euler_angle(2));
set_cam_pose(transToWolrd_new);
// TODO å¹³é¢ï¼Ÿï¼Ÿ
ground_plane_sensor = cam_pose.transToWolrd.transpose() * ground_plane_world;
</code></pre></td></tr></table>
</div>
</div><h3 id="82-è®¡ç®—ä¸‰ä¸ªæ¶ˆå¤±ç‚¹">8.2 è®¡ç®—ä¸‰ä¸ªæ¶ˆå¤±ç‚¹</h3>
<ul>
<li>æ¶ˆå¤±ç‚¹è®¡ç®—å‡½æ•°ä¸º <code>getVanishingPoints()</code></li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-fallback" data-lang="fallback">void getVanishingPoints(const Matrix3d&amp; KinvR,  /* Kalib*invR */
                        double yaw_esti,        /* é‡‡æ ·çš„ç‰©ä½“åèˆªè§’ */
                        Vector2d&amp; vp_1,         /* è¾“å‡ºçš„æ¶ˆå¤±ç‚¹ */
                        Vector2d&amp; vp_2, 
                        Vector2d&amp; vp_3)
</code></pre></td></tr></table>
</div>
</div><ul>
<li>æ¶ˆå¤±ç‚¹è®¡ç®—æ–¹æ³•ï¼š
$$v p_{x}=K \cdot R^{-1} \cdot(\cos (y a w),  \sin (y a w), 0)^T$$
$$v p_{y}=K \cdot R^{-1} \cdot(-\sin (y a w), \cos (y a w), 0)^T$$
$$v p_{z}=K \cdot R^{-1} \cdot(0,0,1)^T$$</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-fallback" data-lang="fallback">vp_1 = homo_to_real_coord_vec&lt;double&gt;( KinvR * Vector3d(cos(yaw_esti), sin(yaw_esti), 0) );     // for object x axis
vp_2 = homo_to_real_coord_vec&lt;double&gt;( KinvR * Vector3d(-sin(yaw_esti), cos(yaw_esti), 0) );    // for object y axis
vp_3 = homo_to_real_coord_vec&lt;double&gt;( KinvR * Vector3d(0,0,1) );                               // for object z axis
</code></pre></td></tr></table>
</div>
</div><p><img src="https://github.com/wuxiaolang/Cube_SLAM_wu/blob/master/wu/pic/VanishingPoints.png?raw=true" alt="VanishingPoints"></p>
<h3 id="83-å¯»æ‰¾å½¢æˆæ¶ˆå¤±ç‚¹çš„è¾¹">8.3 å¯»æ‰¾å½¢æˆæ¶ˆå¤±ç‚¹çš„è¾¹</h3>
<ul>
<li>åœ¨å‡½æ•° <code>VP_support_edge_infos()</code> ä¸­å®ç°
<ul>
<li>è¾“å…¥ï¼šæ¶ˆå¤±ç‚¹çš„åæ ‡ï¼› æ¯æ¡çº¿æ®µçš„ä¸­ç‚¹ï¼› æ¯æ¡çº¿æ®µçš„è§’åº¦ï¼› è§’åº¦åå·®é˜ˆå€¼ï¼›</li>
<li>æ¶ˆå¤±ç‚¹ 1, 2 çš„è§’åº¦åå·®é˜ˆå€¼ä¸º 15 Â°ï¼Œæ¶ˆå¤±ç‚¹ 3 çš„è§’åº¦åå·®é˜ˆå€¼ä¸º 10 Â°ï¼›</li>
</ul>
</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-fallback" data-lang="fallback">Eigen::MatrixXd VP_support_edge_infos(  Eigen::MatrixXd&amp; VPs,                   /* æ¶ˆå¤±ç‚¹çŸ©é˜µ 3*2 */
                                        Eigen::MatrixXd&amp; edge_mid_pts,          /* æ¯æ¡çº¿æ®µçš„ä¸­ç‚¹ nÃ—2 */
                                        Eigen::VectorXd&amp; edge_angles,           /* æ¯æ¡çº¿æ®µçš„åè§’ nÃ—1 */
				        Eigen::Vector2d vp_support_angle_thres) /* æ¶ˆå¤±ç‚¹ä¸è¾¹çš„å¤¹è§’é˜ˆå€¼*/
</code></pre></td></tr></table>
</div>
</div><ul>
<li>æ€æƒ³ï¼šè®¡ç®—æ¶ˆå¤±ç‚¹-çº¿æ®µä¸­ç‚¹æ‰€æ„æˆçº¿æ®µçš„è§’åº¦ï¼Œä¸æ£€æµ‹åˆ°çš„çº¿æ®µçš„è§’åº¦è¿›è¡Œæ¯”è¾ƒï¼Œå¦‚æœè§’åº¦å·®åœ¨é˜ˆå€¼å†…ï¼Œåˆ™è¯¥æ¡çº¿æ®µå¯èƒ½æ˜¯å½¢æˆæ¶ˆå¤±ç‚¹çš„çº¿æ®µï¼ˆç†è®ºä¸Šæ¶ˆå¤±ç‚¹å’Œæ‰€æ”¯æŒçš„çº¿æ®µçš„ä¸­ç‚¹æ˜¯åœ¨ä¸€æ¡çº¿ä¸Šçš„ï¼‰ï¼Œè®°å½•ä¸‹è¿™æ¡è¾¹çš„åè§’å’Œçº¿æ®µ IDã€‚å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</li>
</ul>
<p><img src="https://github.com/wuxiaolang/Cube_SLAM_wu/blob/master/wu/pic/VP_support_edge.png?raw=true" alt="VP_support_edge"></p>
<ul>
<li>è§’åº¦å¹³æ»‘ <code>smooth_jump_angles()</code></li>
<li>â€œæ”¯æ’‘çº¿â€é€‰æ‹©ï¼Œå¦‚æœæ£€æµ‹åˆ°å¤šæ¡æ»¡è¶³è§’åº¦è¦æ±‚çš„è¾¹ï¼Œåˆ™é€‰æ‹©è§’åº¦æœ€å¤§å’Œæœ€å°çš„ï¼Œä½œä¸ºå½¢æˆæ¶ˆå¤±ç‚¹çš„ä¸¤æ¡â€œæ”¯æ’‘çº¿â€ï¼Œå­˜å‚¨åœ¨ <code>MatrixXd all_vp_bound_edge_angles</code> çŸ©é˜µä¸­ã€‚</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-fallback" data-lang="fallback">// NOTE å¦‚æœæœ‰å¤šæ¡è¾¹æ»¡è¶³è¦æ±‚ï¼ˆå¯èƒ½æ£€æµ‹åˆ°å¤šæ¡æ”¯æ’‘çº¿ï¼‰ï¼Œæ¯”è¾ƒå¾—åˆ°è§’åº¦æœ€å¤§å’Œæœ€å°çš„ï¼Œä½œä¸ºä¸¤æ¡æ”¯æ’‘çº¿.
// è§’åº¦æœ€å¤§å’Œæœ€å°çš„è¾¹çš„id
int vp1_low_edge_id;	
vp1_edge_midpt_angle_raw_inlier_shift.maxCoeff(&amp;vp1_low_edge_id);
int vp1_top_edge_id;	
vp1_edge_midpt_angle_raw_inlier_shift.minCoeff(&amp;vp1_top_edge_id);
// TODO ç¬¬ 2 3 ä¸ªæ¶ˆå¤±ç‚¹æ—¶äº¤æ¢æœ€å¤§å’Œæœ€å°å€¼
if (vp_id &gt; 0)
    std::swap(vp1_low_edge_id, vp1_top_edge_id);  // match matlab code
// NOTE è¾“å‡ºï¼šæ¶ˆå¤±ç‚¹ä¸¤è¾¹çš„å¤¹è§’.
all_vp_bound_edge_angles(vp_id,0) = edge_angles(vp_inlier_edge_id[vp1_low_edge_id]);   // it will be 0*1 matrix if not found inlier edges.
all_vp_bound_edge_angles(vp_id,1) = edge_angles(vp_inlier_edge_id[vp1_top_edge_id]);
</code></pre></td></tr></table>
</div>
</div><h3 id="84-è®¡ç®—ç‰©ä½“-8-ä¸ªç‚¹çš„-2dåæ ‡">8.4 è®¡ç®—ç‰©ä½“ 8 ä¸ªç‚¹çš„ 2Dåæ ‡</h3>
<p><img src="https://github.com/wuxiaolang/Cube_SLAM_wu/blob/master/wu/pic/box_corners_2d.png?raw=true" alt="box_corners_2d"></p>
<h4 id="841-é¡¶éƒ¨ç‚¹-1">8.4.1 é¡¶éƒ¨ç‚¹ 1</h4>
<ul>
<li><strong>é¡¶éƒ¨ç¬¬ä¸€ä¸ªç‚¹</strong>ç”±ä¸Šè¾¹ç¼˜é‡‡æ ·çš„ç‚¹ç¡®å®šï¼Œ<strong>å¯èƒ½åœ¨æ£€æµ‹æ¡†é¡¶éƒ¨çš„æŸä¸€ä¸ªä½ç½®</strong>ï¼Œå¯ä»¥å‚è€ƒä¸Šé¢é¡¶è¾¹é‡‡æ ·çš„å›¾ã€‚</li>
</ul>
<h4 id="842-é¡¶éƒ¨ç‚¹-2">8.4.2 é¡¶éƒ¨ç‚¹ 2</h4>
<ul>
<li><strong>æ£€æŸ¥æ¶ˆå¤±ç‚¹ 1 åœ¨å·¦è¾¹è¿˜æ˜¯åœ¨å³è¾¹</strong>
<ul>
<li><code>seg_hit_boundary()</code> å‡½æ•°ä¸¤ä¸ªç‚¹æ„æˆçš„å°„çº¿æ˜¯å¦ä¸ä¸€æ¡è¾¹æœ‰äº¤ç‚¹ï¼Œæ²¡æœ‰äº¤é›†åˆ™è¿”å› [-1 -1]</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-fallback" data-lang="fallback">Vector2d seg_hit_boundary(  const Vector2d&amp; pt_start, 
                            const Vector2d&amp; pt_end, 
                            const Vector4d&amp; line_segment2 )
</code></pre></td></tr></table>
</div>
</div><ul>
<li>å¦‚æœæ¶ˆå¤±ç‚¹ 1 ä¸ä¸Šè¾¹ç¼˜é‡‡æ ·ç‚¹çš„å°„çº¿ä¸è¾¹ç•Œæ¡†çš„å³è¾¹ç•Œæœ‰äº¤ç‚¹ï¼Œåˆ™ä½äºå·¦è¾¹ï¼›</li>
<li>å¦‚æœæ¶ˆå¤±ç‚¹ 1 ä¸ä¸Šè¾¹ç¼˜é‡‡æ ·ç‚¹çš„å°„çº¿ä¸è¾¹ç•Œæ¡†çš„å·¦è¾¹ç•Œæœ‰äº¤ç‚¹ï¼Œåˆ™ä½äºå³è¾¹ï¼›</li>
<li>å‚æ•° <code>vp_1_position</code> è¡¨ç¤ºæ¶ˆå¤±ç‚¹çš„å·¦å³ä½ç½®ï¼š</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-fallback" data-lang="fallback">int vp_1_position = 0;  // 0 initial as fail,  1  on left   2 on right
</code></pre></td></tr></table>
</div>
</div></li>
<li>é¡¶éƒ¨ç¬¬äºŒä¸ªç‚¹ï¼šå³ä¸Šä¸€æ­¥å°„çº¿ä¸å·¦å³è¾¹ç•Œçš„äº¤ç‚¹</li>
</ul>
<h4 id="843-ç¬¬ä¸€ç§æƒ…å½¢ä¸‹çš„é¡¶éƒ¨ç¬¬-3-4-ä¸ªç‚¹">8.4.3 ç¬¬ä¸€ç§æƒ…å½¢ä¸‹çš„é¡¶éƒ¨ç¬¬ 3, 4 ä¸ªç‚¹</h4>
<ul>
<li>ç¬¬ä¸€ç§æƒ…å½¢ï¼šå¯ä»¥è§‚å¯Ÿåˆ°ç‰©ä½“çš„ä¸‰ä¸ªé¢ï¼›</li>
<li><strong>é¡¶éƒ¨ç‚¹ 4</strong> ï¼šæ¶ˆå¤±ç‚¹ 2 ä¸ä¸Šè¾¹ç¼˜é‡‡æ ·ç‚¹çš„å°„çº¿ä¸æ£€æµ‹æ¡†å·¦è¾¹ï¼ˆæˆ–å³è¾¹ï¼‰ç•Œçš„äº¤ç‚¹ï¼›
<ul>
<li>å¦‚æœæ²¡æœ‰äº§ç”Ÿäº¤ç‚¹ï¼Œåˆ™ä¸­æ–­æœ¬æ¬¡æ£€æµ‹ï¼Œè¯´æ˜é‡‡æ ·çš„ä¸Šè¾¹ç¼˜ç‚¹ä¸å‡†ç¡®ã€‚</li>
<li>ç‚¹ 1 ä¸ç‚¹ 4 çš„è·ç¦»å°äºé˜ˆå€¼ <code>shorted_edge_thre</code> ï¼ˆé»˜è®¤ä¸º 20 ï¼‰ï¼Œä¹Ÿå¤±è´¥ï¼›</li>
</ul>
</li>
<li><strong>é¡¶éƒ¨ç‚¹ 3</strong>ï¼šæ¶ˆå¤±ç‚¹ 1 å’Œç‚¹ 3 æ„æˆçš„å°„çº¿ä¸æ¶ˆå¤±ç‚¹ 2 å’Œç‚¹ 2 æ„æˆçš„å°„çº¿çš„äº¤ç‚¹ï¼›
<ul>
<li>å‡½æ•° <code>lineSegmentIntersect()</code> è®¡ç®—<strong>ä¸¤æ¡å°„çº¿çš„äº¤ç‚¹</strong></li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-fallback" data-lang="fallback">Vector2d lineSegmentIntersect(  const Vector2d&amp; pt1_start, const Vector2d&amp; pt1_end,     /* çº¿æ®µ 1*/
                                const Vector2d&amp; pt2_start, const Vector2d&amp; pt2_end,     /* çº¿æ®µ 2*/
                                bool infinite_line)
</code></pre></td></tr></table>
</div>
</div><ul>
<li>å¦‚æœäº¤ç‚¹ä¸åœ¨æ£€æµ‹æ¡†å†…ï¼Œåˆ™å¤±è´¥ï¼›</li>
<li>å¦‚æœç‚¹ 3-4 æˆ–ç‚¹ 3-2 çš„é•¿åº¦å°äºé˜ˆå€¼ï¼Œåˆ™å¤±è´¥ï¼›</li>
</ul>
</li>
</ul>
<h4 id="844-ç¬¬äºŒç§æƒ…å½¢ä¸‹çš„é¡¶éƒ¨ç¬¬-3-4-ä¸ªç‚¹">8.4.4 ç¬¬äºŒç§æƒ…å½¢ä¸‹çš„é¡¶éƒ¨ç¬¬ 3, 4 ä¸ªç‚¹</h4>
<ul>
<li>ç¬¬äºŒç§æƒ…å½¢ï¼šå¯ä»¥è§‚å¯Ÿåˆ°ç‰©ä½“çš„ä¸¤ä¸ªé¢ï¼›</li>
<li><strong>é¡¶éƒ¨ç‚¹ 3</strong>ï¼šæ¶ˆå¤±ç‚¹ 2 ä¸é¡¶éƒ¨ç‚¹ 2 çš„è¿çº¿ä¸æ£€æµ‹æ¡†å·¦è¾¹ç•Œï¼ˆæˆ–å³ï¼‰çš„äº¤ç‚¹ï¼›
<ul>
<li>è‹¥æ²¡æœ‰äº¤ç‚¹ï¼Œåˆ™å¤±è´¥ï¼›</li>
<li>è‹¥ç‚¹ 2-3 çš„è·ç¦»å°äºé˜ˆå€¼ï¼Œåˆ™å¤±è´¥ï¼›</li>
</ul>
</li>
<li><strong>é¡¶éƒ¨ç‚¹ 4</strong>ï¼šæ¶ˆå¤±ç‚¹ 1 å’Œé¡¶éƒ¨ç‚¹ 3 æ„æˆçš„å°„çº¿ä¸æ¶ˆå¤±ç‚¹ 2 å’Œé¡¶éƒ¨ç‚¹ 1 æ„æˆçš„å°„çº¿çš„äº¤ç‚¹ï¼›
<ul>
<li>è‹¥äº¤ç‚¹ä¸åœ¨æ£€æµ‹æ¡†å†…ï¼Œåˆ™å¤±è´¥ï¼›</li>
<li>å¦‚æœç‚¹ 3-4 æˆ–ç‚¹ 4-1 çš„é•¿åº¦å°äºé˜ˆå€¼ï¼Œåˆ™å¤±è´¥ï¼›</li>
</ul>
</li>
</ul>
<h4 id="845-åº•éƒ¨ç‚¹-5">8.4.5 åº•éƒ¨ç‚¹ 5</h4>
<ul>
<li>åº•éƒ¨ç‚¹æƒ…å½¢ 1ï¼Œ 2 çš„è®¡ç®—æ–¹æ³•ç›¸åŒï¼›</li>
<li><strong>åº•éƒ¨ç‚¹ 5</strong>ï¼šæ¶ˆå¤±ç‚¹ 3 å’Œé¡¶éƒ¨ç‚¹ 3 çš„è¿çº¿ä¸æ£€æµ‹æ¡†åº•è¾¹ï¼ˆæ˜¯å¦è¿›è¡Œäº†é«˜åº¦é‡‡æ ·ï¼‰çš„äº¤ç‚¹ï¼›
<ul>
<li>å¦‚æœæ²¡æœ‰äº¤ç‚¹ï¼Œåˆ™å¤±è´¥ï¼›</li>
<li>å¦‚æœç‚¹ 3-5 çš„è·ç¦»å°äºé˜ˆå€¼ï¼Œåˆ™å¤±è´¥ã€‚</li>
</ul>
</li>
</ul>
<h4 id="846-åº•éƒ¨ç‚¹-6">8.4.6 åº•éƒ¨ç‚¹ 6</h4>
<ul>
<li><strong>åº•éƒ¨ç‚¹ 6</strong>ï¼šæ¶ˆå¤±ç‚¹ 2 å’Œåº•éƒ¨ç‚¹ 5 çš„è¿çº¿ä¸æ¶ˆå¤±ç‚¹ 3 ä¸é¡¶éƒ¨ç‚¹ 2 è¿çº¿çš„äº¤ç‚¹ï¼›
<ul>
<li>è‹¥äº¤ç‚¹ä¸åœ¨æ£€æµ‹æ¡†å†…ï¼Œåˆ™å¤±è´¥ï¼›</li>
<li>è‹¥ç‚¹ 6-2 æˆ–ç‚¹ 6-5 çš„è·ç¦»å°äºé˜ˆå€¼ï¼Œåˆ™å¤±è´¥ï¼›</li>
</ul>
</li>
</ul>
<h4 id="847-åº•éƒ¨ç‚¹-7">8.4.7 åº•éƒ¨ç‚¹ 7</h4>
<ul>
<li><strong>åº•éƒ¨ç‚¹ 7</strong>ï¼šæ¶ˆå¤±ç‚¹ 1 å’Œåº•éƒ¨ç‚¹ 6 çš„è¿çº¿ä¸æ¶ˆå¤±ç‚¹ 3 ä¸é¡¶éƒ¨ç‚¹ 1 è¿çº¿çš„äº¤ç‚¹ï¼›
<ul>
<li>è‹¥äº¤ç‚¹ä¸åœ¨æ£€æµ‹æ¡†å†…ï¼Œåˆ™å¤±è´¥ï¼›</li>
<li>è‹¥ç‚¹ 7-1 æˆ–ç‚¹ 7-6 çš„è·ç¦»å°äºé˜ˆå€¼ï¼Œåˆ™å¤±è´¥ï¼›</li>
</ul>
</li>
</ul>
<h4 id="848-åº•éƒ¨ç‚¹-8">8.4.8 åº•éƒ¨ç‚¹ 8</h4>
<ul>
<li><strong>åº•éƒ¨ç‚¹ 8</strong>ï¼šæ¶ˆå¤±ç‚¹ 1 å’Œåº•éƒ¨ç‚¹ 5 çš„è¿çº¿ä¸æ¶ˆå¤±ç‚¹ 2 ä¸é¡¶éƒ¨ç‚¹ 7 è¿çº¿çš„äº¤ç‚¹ï¼›
<ul>
<li>è‹¥äº¤ç‚¹ä¸åœ¨æ£€æµ‹æ¡†å†…ï¼Œåˆ™å¤±è´¥ï¼›</li>
<li>è‹¥ç‚¹ 8-4 æˆ–ç‚¹ 8-5 çš„è·ç¦»å°äºé˜ˆå€¼ï¼Œåˆ™å¤±è´¥ï¼›</li>
</ul>
</li>
<li>ç‰©ä½“ <strong>8 ä¸ªç‚¹çš„ 2Dåæ ‡</strong>å­˜å‚¨åœ¨ <code>box_corners_2d_float</code> çŸ©é˜µä¸­</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-fallback" data-lang="fallback">MatrixXd box_corners_2d_float(2,8);
box_corners_2d_float &lt;&lt; corner_1_top, corner_2_top, corner_3_top, corner_4_top, 
                        corner_5_down, corner_6_down, corner_7_down, corner_8_down;
</code></pre></td></tr></table>
</div>
</div><h3 id="85-è¯¯å·®è®¡ç®—ä¸€">8.5 è¯¯å·®è®¡ç®—ï¼ˆä¸€ï¼‰</h3>
<h4 id="850-è¯¯å·®å­˜å‚¨">8.5.0 è¯¯å·®å­˜å‚¨</h4>
<ul>
<li>å‰å››é¡¹</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-fallback" data-lang="fallback">Vector4d(   config_id, 	        /* æ¨¡å¼æƒ…å½¢ */
            vp_1_position,      /* vp1çš„ä½ç½® */
            obj_yaw_esti,       /* é‡‡æ ·çš„ç‰©ä½“åèˆªè§’ */
            sample_top_pt_id);	/* ä¸Šè¾¹ç¼˜é‡‡æ ·ç‚¹ */
</code></pre></td></tr></table>
</div>
</div><ul>
<li>å¾€åä¸‰é¡¹</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-fallback" data-lang="fallback">Vector3d(   sum_dist/obj_diaglength_expan, 	/* å¹³å‡è·ç¦»è¯¯å·®ï¼Ÿ */
            total_angle_diff, 			/* è§’åº¦è¯¯å·® */
            down_expand_sample);		/* é«˜åº¦é‡‡æ ·ï¼Œæ˜¯å¦æ‰©å……åº•éƒ¨ 0ï¼Œ 10ï¼Œ 20 */
</code></pre></td></tr></table>
</div>
</div><ul>
<li>åä¸¤é¡¹ï¼Œé‡‡æ ·çš„ç›¸æœº roll pitch è§’ï¼ˆä¸é‡‡æ ·åˆ™ç›´æ¥å–ç›¸æœºçš„è§’åº¦ï¼‰</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-fallback" data-lang="fallback">Vector2d(   cam_roll_samples[cam_roll_id],	/* é‡‡æ ·ç›¸æœº roll è§’ */
            cam_pitch_samples[cam_pitch_id]);	/* é‡‡æ ·ç›¸æœº pitch è§’ */
</code></pre></td></tr></table>
</div>
</div><h4 id="851-è·ç¦»è¯¯å·®">8.5.1 è·ç¦»è¯¯å·®</h4>
<ul>
<li>è·ç¦»è¯¯å·®è®¡ç®—å‡½æ•°ä¸ºï¼š<code>box_edge_sum_dists()</code></li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-fallback" data-lang="fallback">double box_edge_sum_dists(  const cv::Mat&amp; dist_map,            /* è·ç¦»å˜æ¢å›¾ */
                            const MatrixXd&amp; box_corners_2d,     /* 8 ä¸ªé¡¶ç‚¹çš„ 2Dåæ ‡(ä»¥æ£€æµ‹æ¡†ä¸ºè½´) */
                            const MatrixXi&amp; edge_pt_ids,        /* å¯è§çš„è¾¹ */
                            bool  reweight_edge_distance)
</code></pre></td></tr></table>
</div>
</div><ul>
<li>å°† 8 ä¸ªç‚¹åœ¨å›¾åƒä¸­çš„åæ ‡è½¬æ¢æˆåœ¨<strong>æ£€æµ‹æ¡†ä¸­çš„åæ ‡</strong>ï¼ˆ<strong>ä»¥æ£€æµ‹æ¡†å·¦ä¸Šè§’ä¸ºåæ ‡åŸç‚¹</strong>ï¼‰</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-fallback" data-lang="fallback">MatrixXd box_corners_2d_float_shift(2,8);
box_corners_2d_float_shift.row(0) = box_corners_2d_float.row(0).array() - left_x_expan_distmap;
box_corners_2d_float_shift.row(1) = box_corners_2d_float.row(1).array() - top_y_expan_distmap;
</code></pre></td></tr></table>
</div>
</div><ul>
<li><strong>æƒ…å½¢ 1</strong>ï¼š
<ul>
<li>æƒ…å½¢ 1 ä¸‹å¯è§‚å¯Ÿåˆ° 3 ä¸ªé¢ï¼Œå…± 9 æ¡<strong>å¯è§è¾¹</strong>ï¼š</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-fallback" data-lang="fallback">visible_edge_pt_ids.resize(9,2); 
visible_edge_pt_ids &lt;&lt; 1,2,  2,3,  3,4,  4,1,  2,6,  3,5,  4,8,  5,8,  5,6;
</code></pre></td></tr></table>
</div>
</div><ul>
<li><strong>å½¢æˆæ¶ˆå¤±ç‚¹çš„çº¿æ®µ</strong></li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-fallback" data-lang="fallback">// ä¸‰ä¸ªæ¶ˆå¤±ç‚¹æ‰€éœ€è¦çš„ä¸¤æ¡è¾¹					
vps_box_edge_pt_ids.resize(3,4); 
// 1_2 ä¸ 8_5 äº¤ç‚¹å¾—åˆ°vp1	4_1 ä¸ 5_6 äº¤ç‚¹å¾—åˆ°vp1	
vps_box_edge_pt_ids &lt;&lt; 1,2,8,5,  4,1,5,6,  4,8,2,6; 
</code></pre></td></tr></table>
</div>
</div></li>
<li><strong>æƒ…å½¢ 2</strong>ï¼š
<ul>
<li>æƒ…å½¢ 2 ä¸‹å¯è§‚å¯Ÿåˆ° 2 ä¸ªé¢ï¼Œå…± 7 æ¡<strong>å¯è§è¾¹</strong>ï¼š</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-fallback" data-lang="fallback">visible_edge_pt_ids.resize(7,2); 
visible_edge_pt_ids&lt;&lt;1,2, 2,3, 3,4, 4,1, 2,6, 3,5, 5,6;
</code></pre></td></tr></table>
</div>
</div><ul>
<li><strong>å½¢æˆæ¶ˆå¤±ç‚¹çš„çº¿æ®µ</strong></li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-fallback" data-lang="fallback">// ä¸‰ä¸ªæ¶ˆå¤±ç‚¹æ‰€éœ€è¦çš„ä¸¤æ¡è¾¹					
vps_box_edge_pt_ids.resize(3,4); 
vps_box_edge_pt_ids&lt;&lt;1,2,3,4, 4,1,5,6, 3,5,2,6; 
</code></pre></td></tr></table>
</div>
</div></li>
<li><strong>è·ç¦»è¯¯å·®è®¡ç®—</strong>ï¼šé‡‡æ ·å¯è§è¾¹ä¸Šçš„ç‚¹ï¼Œè®¡ç®—ç‚¹åœ¨è·ç¦»å˜æ¢å¾—åˆ°çš„å›¾ä¸­çš„å€¼ï¼Œç´¯åŠ å¾—åˆ°è¯¯å·®å€¼ï¼›
<ul>
<li>ä»å‰é¢çš„è·ç¦»å›¾ä¸­å¯ä»¥çœ‹å‡ºï¼Œè·ç¦»å›¾æ˜¾ç¤ºå›¾åƒä¸­æ¯ä¸€ä¸ªéé›¶ç‚¹è·ç¦»ç¦»è‡ªå·±æœ€è¿‘çš„é›¶ç‚¹çš„è·ç¦»ï¼Œ<strong>å›¾åƒä¸Šè¶Šäº®çš„ç‚¹ï¼Œä»£è¡¨äº†ç¦»é›¶ç‚¹ï¼ˆè¾¹ç¼˜ï¼‰çš„è·ç¦»è¶Šè¿œ</strong>ï¼›ï¼ˆ<!-- raw HTML omitted -->ç–‘é—®ï¼šcannyæ£€æµ‹æ²¡æ£€æµ‹å‡ºè¾¹ï¼Œå¯¼è‡´è·ç¦»å›¾ä¸å‡†ç¡®ï¼Œä½†æ²¡æ£€æµ‹å‡ºçš„è¾¹è¢«LSDè¾¹ç¼˜æ£€æµ‹å‡ºäº†å‘¢ï¼Ÿé‚£è¿™æ¡è¾¹å²‚ä¸æ˜¯è¯¯å·®ä¼šç‰¹åˆ«å¤§ï¼Ÿï¼Ÿ<!-- raw HTML omitted -->ï¼‰</li>
<li>åœ¨<strong>å¯è§è¾¹</strong>ï¼ˆä¸æ˜¯æ£€æµ‹åˆ°çš„çº¿æ®µï¼Œæ˜¯ç»˜åˆ¶çš„è¾¹ï¼‰ä¸Š<strong>é‡‡æ ·ä¸åŒçš„ç‚¹</strong>ï¼š</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-fallback" data-lang="fallback">Vector2d sample_pt = sample_ind/10.0 * corner_tmp1 + (1-sample_ind/10.0) * corner_tmp2;
</code></pre></td></tr></table>
</div>
</div><ul>
<li>è®¡ç®—<strong>æ¯ä¸ªç‚¹çš„è·ç¦»å€¼</strong></li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-fallback" data-lang="fallback">float dist1 = dist_map.at&lt;float&gt;(int(sample_pt(1)),int(sample_pt(0)));
</code></pre></td></tr></table>
</div>
</div><ul>
<li>æ˜¯å¦<strong>åŠ æƒ</strong>ï¼Œç„¶å<strong>ç´¯åŠ </strong></li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span><span class="lnt">9
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-fallback" data-lang="fallback">// æ˜¯å¦é‡æ–°åŠ æƒ
// TODO ç¬¬5,6,7æ¡è¾¹çš„æµ‹é‡æ›´å€¼å¾—ä¿¡èµ–ï¼Ÿï¼Ÿ
if (reweight_edge_distance)
 {
     if ((4&lt;=edge_id) &amp;&amp; (edge_id&lt;=5))       // å¯¹ç¬¬ 5,6 æ¡è¾¹ Ã— 1.5
          dist1 = dist1 * 3.0 / 2.0;
     if (6==edge_id)                         // å¯¹ç¬¬ 7 æ¡è¾¹  Ã— 2
          dist1 = dist1 * 2.0;
 }
</code></pre></td></tr></table>
</div>
</div><ul>
<li>è¯¯å·®ç´¯åŠ ï¼Œå¹¶æ±‚<strong>å¹³å‡</strong></li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-fallback" data-lang="fallback">sum_dist = sum_dist + dist1;
mean_dist = sum_dist / obj_diaglength_expanï¼› //obj_diaglength_expanæ˜¯è¾¹ç•Œæ¡†å¯¹è§’çº¿é•¿åº¦.
</code></pre></td></tr></table>
</div>
</div></li>
</ul>
<h4 id="852-è§’åº¦è¯¯å·®">8.5.2 è§’åº¦è¯¯å·®</h4>
<ul>
<li>è§’åº¦è¯¯å·®å‡½æ•°ï¼š<code>box_edge_alignment_angle_error()</code></li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-fallback" data-lang="fallback">double box_edge_alignment_angle_error(  const MatrixXd&amp; all_vp_bound_edge_angles,   /* æ¶ˆå¤±ç‚¹ä¸è¾¹çš„ä¸¤ä¸ªè§’åº¦ */
                                        const MatrixXi&amp; vps_box_edge_pt_ids,        /* æ¯ä¸ªæ¶ˆå¤±ç‚¹æ¥æºçš„ä¸¤æ¡è¾¹ */
                                        const MatrixXd&amp; box_corners_2d)             /* 8 ä¸ªé¡¶ç‚¹çš„ 2Dåæ ‡ */
</code></pre></td></tr></table>
</div>
</div><ul>
<li><strong>è§’åº¦è¯¯å·®</strong> = | å½¢æˆæ¶ˆå¤±ç‚¹çš„è¾¹ï¼ˆ2D ç‚¹æ„æˆï¼‰çš„è§’åº¦ - çº¿æ£€æµ‹å¾—åˆ°çš„å¯¹åº”è¾¹çš„è§’åº¦ |</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span><span class="lnt">9
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-fallback" data-lang="fallback">for (int i = 0; i &lt; vp_bound_angles_valid.size(); i++)
{
    // NOTE ã€è®¡ç®—è§’åº¦è¯¯å·®ã€‘ï¼Œå½¢æˆæ¶ˆå¤±ç‚¹çš„è¾¹çš„è§’åº¦-æ¶ˆå¤±ç‚¹ä¸æ£€æµ‹åˆ°çš„è¾¹ç¼˜çš„è§’åº¦.
    double temp = std::abs(box_edge_angle - vp_bound_angles_valid[i]);
    temp = std::min( temp, M_PI-temp );
    if (temp&lt;angle_diff_temp)
        angle_diff_temp = temp;
}
total_angle_diff = total_angle_diff + angle_diff_temp;
</code></pre></td></tr></table>
</div>
</div><ul>
<li>å¦‚æœæ²¡æœ‰æ‰¾åˆ°å½¢æˆæ¶ˆå¤±ç‚¹çš„è¾¹ï¼Œåˆ™èµ‹äºˆå›ºå®šçš„åå·® 15 Â°ï¼š</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-fallback" data-lang="fallback">double not_found_penalty = 30.0/180.0*M_PI*2;
total_angle_diff = total_angle_diff + not_found_penalty;
</code></pre></td></tr></table>
</div>
</div><p><img src="https://github.com/wuxiaolang/Cube_SLAM_wu/blob/master/wu/pic/angle_dist_error.png?raw=true" alt="angle_dist_error"></p>
<h4 id="853-è·ç¦»-è§’åº¦ç»¼åˆè¯„åˆ†">8.5.3 è·ç¦»-è§’åº¦ç»¼åˆè¯„åˆ†</h4>
<ul>
<li>å½’ä¸€åŒ–è¯¯å·®å‡½æ•°ï¼š<code>fuse_normalize_scores_v2()</code></li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-fallback" data-lang="fallback">// BRIEF åŠ æƒä¸åŒçš„è¯¯å·®è¯„ä¼° weighted sum different score
void fuse_normalize_scores_v2(  const VectorXd&amp; dist_error,         /* è·ç¦»è¯¯å·® */           
                                const VectorXd&amp; angle_error,        /* è§’åº¦è¯¯å·® */
                                VectorXd&amp; combined_scores,          /* ç»¼åˆå¾—åˆ† */    
                                std::vector&lt;int&gt;&amp; final_keep_inds,  /* æœ€ç»ˆçº³å…¥è®¡ç®—çš„æµ‹é‡çš„ID */
			        double weight_vp_angle,             /* è§’åº¦è¯¯å·®çš„æƒé‡ */
                                bool whether_normalize)             /* æ˜¯å¦å½’ä¸€åŒ–ä¸¤ä¸ªè¯¯å·® */
</code></pre></td></tr></table>
</div>
</div><ul>
<li>åˆ†åˆ«å¯¹è·ç¦»è¯¯å·®å’Œè§’åº¦è¯¯å·®ä»¥é€’å¢çš„æ–¹å¼å–<strong>æ‰€æœ‰æµ‹é‡æ¬¡æ•°çš„ 2/3</strong>ï¼›</li>
<li>å†å¯»æ‰¾è¿™<strong>ä¸¤ä¸ªåºåˆ—çš„äº¤é›†</strong>ï¼Œå³ä¸¤ä¸ªè¯¯å·®éƒ½åœ¨å‰ 2/3 çš„æµ‹é‡ï¼›</li>
<li>å¯¹äº¤é›†ä¸­æ¯ä¸€æ¬¡æµ‹é‡<strong>å½’ä¸€åŒ–ä¸¤ä¸ªè¯¯å·®</strong>ï¼š</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-fallback" data-lang="fallback">// STEP è¯¯å·®å½’ä¸€åŒ–.
if (whether_normalize &amp;&amp; (new_data_size &gt; 1))
{
    // è·ç¦»è¯¯å·®             ï¼ˆæ‰€æœ‰çš„è·ç¦» - æœ€å°è·ç¦»å€¼ï¼‰/ (æœ€å¤§è·ç¦» - æœ€å°è·ç¦»)
    combined_scores  = (dist_kept.array() - min_dist_error) / (max_dist_error - min_dist_error);
    if ((max_angle_error - min_angle_error) &gt; 0)
    {
	// è§’åº¦è¯¯å·®        ï¼ˆæ‰€æœ‰è§’åº¦è¯¯å·® - æœ€å°è§’åº¦è¯¯å·®ï¼‰ / ï¼ˆæœ€å¤§è§’åº¦è¯¯å·® - æœ€å°è§’åº¦è¯¯å·®ï¼‰
	angle_kept = (angle_kept.array() - min_angle_error) / (max_angle_error - min_angle_error);

	// NOTE è”åˆè¯„åˆ†ï¼Œï¼ˆè·ç¦»è¯¯å·® + è§’åº¦æƒé‡Ã—è§’åº¦è¯¯å·®ï¼‰/ï¼ˆ1 + è§’åº¦æƒé‡ï¼‰
		combined_scores = (combined_scores + weight_vp_angle * angle_kept) / (1 + weight_vp_angle);
    }
    else
	combined_scores = (combined_scores + weight_vp_angle*angle_kept)/(1+weight_vp_angle);
}
else
	combined_scores = (dist_kept + weight_vp_angle * angle_kept) / (1 + weight_vp_angle);    
</code></pre></td></tr></table>
</div>
</div><h3 id="86-ç”Ÿæˆ-3d-ç«‹æ–¹ä½“ææ¡ˆ">8.6 ç”Ÿæˆ 3D ç«‹æ–¹ä½“ææ¡ˆ</h3>
<ul>
<li>2D é¡¶ç‚¹æ¢å¤ 3Dç«‹æ–¹ä½“ä¿¡æ¯ï¼š<code>change_2d_corner_to_3d_object()</code></li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-fallback" data-lang="fallback">// BRIEF    ç”±2Dé¡¶ç‚¹æ¢å¤å‡º 3D ç«‹æ–¹ä½“ä¿¡æ¯.
void change_2d_corner_to_3d_object( const MatrixXd&amp; box_corners_2d_float,   /* 8 ä¸ªç‚¹çš„ 2D åæ ‡*/
                                    const Vector3d&amp; configs,                /* æ¨¡å¼ï¼Œvp1çš„ä½ç½®ï¼Œåèˆªè§’*/
                                    const Vector4d&amp; ground_plane_sensor,    /* æ³•å¹³é¢ï¼Ÿ*/
				    const Matrix4d&amp; transToWolrd,           /* ç›¸æœºæ—‹è½¬ */
                                    const Matrix3d&amp; invK,                   /* ç›¸æœºå†…å‚çš„é€†çŸ©é˜µ */
                                    Eigen::Matrix&lt;double, 3, 4&gt;&amp; projectionMatrix,  /* æŠ•å½±çŸ©é˜µ */
				    cuboid&amp; sample_obj)                     /* 3Dææ¡ˆ */
</code></pre></td></tr></table>
</div>
</div><h4 id="861-è®¡ç®—ç«‹æ–¹ä½“åº•éƒ¨å››ä¸ª-3dç‚¹">8.6.1 è®¡ç®—ç«‹æ–¹ä½“åº•éƒ¨å››ä¸ª 3Dç‚¹</h4>
<ul>
<li><code>plane_hits_3d()</code> å‡½æ•°å‚æ•°ï¼š</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-fallback" data-lang="fallback">// @PARAM obj_gnd_pt_world_3d   è®¡ç®—ä¸–ç•Œåæ ‡ç³»ä¸­çš„ 3D ç‚¹ï¼ˆç«‹æ–¹ä½“åº•éƒ¨ï¼‰ .
Matrix3Xd obj_gnd_pt_world_3d; 
plane_hits_3d(  transToWolrd,                      /* ç›¸æœºæ—‹è½¬çŸ©é˜µ */
                invK,                              /* ç›¸æœºå†…å‚çš„é€†çŸ©é˜µ */
                ground_plane_sensor,               /* ç›¸æœºç³»ä¸‹çš„åœ°å¹³é¢*/
                box_corners_2d_float.rightCols(4), /* ç«‹æ–¹ä½“åº•éƒ¨çš„ 4 ä¸ª 2D ç‚¹ */
                obj_gnd_pt_world_3d);              /* ç«‹æ–¹ä½“åº•éƒ¨çš„ 4 ä¸ª 3D ç‚¹ */
</code></pre></td></tr></table>
</div>
</div><ul>
<li>é¦–å…ˆå°† 2 * 4 çš„ 4 ä¸ª <strong>2D åæ ‡</strong>è½¬æ¢æˆ<strong>é½æ¬¡å½¢å¼ 3 Ã— 4</strong>;</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-fallback" data-lang="fallback">é½æ¬¡åƒç´ ç‚¹ï¼š
344.614   528.2  429.72 255.345
    424 281.372 233.359 340.603
      1       1       1       1
</code></pre></td></tr></table>
</div>
</div><ul>
<li>è®¡ç®—åƒç´ ç‚¹å¯¹åº”çš„<strong>æŠ•å½±å°„çº¿</strong>ï¼ˆ Z ä¸ç¡®å®šå°±æ˜¯ä¸€æ¡å°„çº¿ï¼Œç¡®å®š Z äº†å°±æ˜¯ä¸€ä¸ªç¡®å®šçš„ 3D ç‚¹ï¼‰:
$$
l_{ray} = K^{-1}\begin{pmatrix}
u,v,1\end{pmatrix}^T
$$</li>
<li>é€šè¿‡ç›¸æœºå¹³é¢<strong>ç¡®å®šåº•éƒ¨ 3D ç‚¹</strong>
<ul>
<li>è®¡ç®—ç›¸æœºç³»ä¸‹çš„å¹³é¢</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-fallback" data-lang="fallback">// ç›¸æœºç³»ä¸‹çš„åœ°å¹³é¢
ground_plane_sensor = cam_pose.transToWolrd.transpose()*ground_plane_world;
</code></pre></td></tr></table>
</div>
</div><ul>
<li>è®¡ç®—å°„çº¿ä¸å¹³é¢çš„äº¤ç‚¹ï¼Œç¡®å®š 3D ç‚¹ï¼š<code>ray_plane_interact()</code> å‡½æ•°</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-fallback" data-lang="fallback">ray_plane_interact( pts_ray,        /* æŠ•å½±å°„çº¿ */
                    plane_sensor,   /* ç›¸æœºç³»ä¸‹çš„å¹³é¢ */
                    pts_3d_sensor); /* è¾“å‡ºçš„ 3D ç‚¹ */
</code></pre></td></tr></table>
</div>
</div><ul>
<li>å‡½æ•°</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span><span class="lnt">9
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-fallback" data-lang="fallback">// BRIEF å°„çº¿ä¸º 3Ã—n ï¼Œæ¯åˆ—éƒ½æ˜¯ä»åŸç‚¹å¼€å§‹çš„ä¸€æ¡å°„çº¿  å¹³é¢ï¼ˆ4*1ï¼‰ï¼Œè®¡ç®—å°„çº¿çš„äº¤ç‚¹ 3Ã—n.
//rays is 3*n, each column is a ray staring from origin  plane is (4ï¼Œ1ï¼‰ parameters, compute intersection  output is 3*n 
void ray_plane_interact(const MatrixXd &amp;rays,           
                        const Eigen::Vector4d &amp;plane,
                        MatrixXd &amp;intersections)
{
    VectorXd frac = -plane[3] / (plane.head(3).transpose() * rays).array();   //n*1 
    intersections = frac.transpose().replicate&lt;3,1&gt;().array() * rays.array();
}
</code></pre></td></tr></table>
</div>
</div></li>
</ul>
<h4 id="862-è®¡ç®—ç«‹æ–¹ä½“é¡¶éƒ¨å››ä¸ª-3dç‚¹">8.6.2 è®¡ç®—ç«‹æ–¹ä½“é¡¶éƒ¨å››ä¸ª 3Dç‚¹</h4>
<ul>
<li><code>Matrix3Xd obj_top_pt_world_3d</code>ï¼ŒåŒä¸Šè°ƒç”¨ä¸Šé¢çš„å‡½æ•°è®¡ç®—ï¼›</li>
</ul>
<h4 id="863-ç‰©ä½“çš„-9-è‡ªç”±åº¦è¡¨ç¤º">8.6.3 ç‰©ä½“çš„ 9 è‡ªç”±åº¦è¡¨ç¤º</h4>
<ul>
<li>x, y åæ ‡å–å››ä¸ªç‚¹çš„å¹³å‡å€¼ï¼› z åæ ‡å– z çš„ä¸€åŠï¼›</li>
<li>æ–¹å‘ï¼šå–æœ€ç»ˆææ¡ˆå¯¹åº”çš„åèˆªè§’é‡‡æ ·å€¼ï¼›</li>
<li>å°ºåº¦ï¼šé•¿å®½é«˜ï¼›</li>
<li>æ¨¡å¼ï¼šå‡ ä¸ªé¢ï¼Œæ¶ˆå¤±ç‚¹ 1 çš„ä½ç½®ã€‚</li>
</ul>
<h4 id="864-è®¡ç®—-8-ä¸ªç‚¹çš„-3dä¸–ç•Œåæ ‡">8.6.4 è®¡ç®— 8 ä¸ªç‚¹çš„ 3Dä¸–ç•Œåæ ‡</h4>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-fallback" data-lang="fallback">sample_obj.box_corners_3d_world = compute3D_BoxCorner(sample_obj);
</code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-fallback" data-lang="fallback">// BRIEF  è®¡ç®—ç«‹æ–¹ä½“çš„ 3D åæ ‡.
Matrix3Xd compute3D_BoxCorner(const cuboid&amp; cube_obj)
{
    //@PARAM    corners_body    å­˜å‚¨ç«‹æ–¹ä½“çš„3Dåæ ‡.
    MatrixXd corners_body;
    corners_body.resize(3,8);
    // å…«ä¸ª3Dç‚¹       1   2   3   4   5   6   7   8
    corners_body &lt;&lt;   1,  1, -1, -1,  1,  1, -1, -1,
		      1, -1, -1,  1,  1, -1, -1,  1,
		     -1, -1, -1, -1,  1,  1,  1,  1;

    // è®¡ç®— 3D åæ ‡                                         ç›¸ä¼¼å˜æ¢
    MatrixXd corners_world = homo_to_real_coord&lt;double&gt;(similarityTransformation(cube_obj) * real_to_homo_coord&lt;double&gt;(corners_body));
    
    return corners_world;
}
</code></pre></td></tr></table>
</div>
</div><h3 id="87-è¯¯å·®è®¡ç®—äºŒ">8.7 è¯¯å·®è®¡ç®—ï¼ˆäºŒï¼‰</h3>
<h4 id="871-æ­ªæ–œæ¯”">8.7.1 æ­ªæ–œæ¯”</h4>
<ul>
<li>æ­ªæ–œæ¯” = é•¿åº¦ / å®½åº¦ï¼›</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-fallback" data-lang="fallback">// NOTE æ­ªæ–œæ¯”ï¼šé•¿/å®½.
// head(2).maxCoeff()ï¼šå°ºåº¦çš„å‰ä¸¤é¡¹xyä¸­è¾ƒå¤§è€…ï¼šé•¿
// head(2).minCoeff()ï¼šå°ºåº¦çš„å‰ä¸¤é¡¹xyä¸­è¾ƒå°è€…ï¼šå®½
double skew_ratio = sample_obj-&gt;scale.head(2).maxCoeff()/sample_obj-&gt;scale.head(2).minCoeff();
</code></pre></td></tr></table>
</div>
</div><h4 id="872-è®¡ç®—æ‰€æœ‰è¯¯å·®">8.7.2 è®¡ç®—æ‰€æœ‰è¯¯å·®</h4>
<ul>
<li>å½’ä¸€åŒ–ææ¡ˆçš„<strong>æ€»ä½“è¯¯å·®ï¼šè·ç¦»+è§’åº¦+æ­ªæ–œæ¯”è¯¯å·®</strong></li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-fallback" data-lang="fallback">// è®¡ç®—æ€»ä½“è¯¯å·®
for (int box_id = 0; box_id &lt; raw_obj_proposals.size(); box_id++)
{
	cuboid* sample_obj = raw_obj_proposals[box_id];
	// è®¡ç®—æ­ªæ–œæ¯”è¯¯å·® skew_ratio - 1ï¼Œè¦æ±‚å¤§äº0
	double skew_error = weight_skew_error*std::max(sample_obj-&gt;skew_ratio - nominal_skew_ratio,0.0);
				
	// TODO è‹¥å¤§äºæœ€å¤§æ­ªæ–œæ¯” 3 ï¼Œåˆ™è¯¯å·®ä¸º100
	if (sample_obj-&gt;skew_ratio &gt; max_cut_skew)
	skew_error = 100;

	// NOTE æ–°çš„è¯¯å·®ï¼šè·ç¦»+è§’åº¦+æ­ªæ–œæ¯”è¯¯å·®
	double new_combined_error = sample_obj-&gt;normalized_error + weight_skew_error*skew_error;	// TODO è¿™é‡Œè¿˜ä¹˜äº†ä¸€ä¸ªæƒé‡ï¼Ÿå‰é¢ä¹Ÿä¹˜äº†.
	all_combined_score(box_id) = new_combined_error;
}
</code></pre></td></tr></table>
</div>
</div><h4 id="873-ç¡®å®šæœ€ç»ˆææ¡ˆ">8.7.3 ç¡®å®šæœ€ç»ˆææ¡ˆ</h4>
<ul>
<li>å¯¹è¯¯å·®è¿›è¡Œæ’åºï¼Œ<strong>é€‰æ‹©è¯¯å·®æœ€å°çš„ä¸€ä¸ªä½œä¸ºæœ€ç»ˆææ¡ˆ</strong>ï¼›</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-fallback" data-lang="fallback">// STEP ä¿ç•™è¯¯å·®æœ€å°çš„ææ¡ˆ.
// ææ¡ˆçš„ç´¢å¼•ï¼ˆIDï¼‰å¹¶ä» 0 å¼€å§‹é€’å¢èµ‹å€¼.
std::vector&lt;int&gt; sort_idx_small(all_combined_score.rows());   
iota(sort_idx_small.begin(), sort_idx_small.end(), 0);

// å¯¹ all_combined_score çš„å‰ actual_cuboid_num_smallï¼ˆ1ï¼‰ é¡¹è¿›è¡Œé€’å¢.
sort_indexes(	all_combined_score, 		/* æ£€ç´¢æ¯”è¾ƒçš„åºåˆ— */
                sort_idx_small,				/* æŒ‰ç…§all_combined_scoreä¸­è¯¯å·®ä»å°åˆ°è¾¾æ’åºè¯¯å·®å¯¹åº”çš„ID */
		actual_cuboid_num_small);

for (int ii = 0; ii &lt; actual_cuboid_num_small; ii++) // use sorted index
{
    all_object_cuboids[object_id].push_back(raw_obj_proposals[sort_idx_small[ii]]);
    //std::cout &lt;&lt; &#34;sort_idx_small[ii]ï¼š&#34; &lt;&lt; sort_idx_small[ii] &lt;&lt; std::endl;
}
</code></pre></td></tr></table>
</div>
</div><h3 id="88-ç»˜åˆ¶ææ¡ˆ">8.8 ç»˜åˆ¶ææ¡ˆ</h3>
<ul>
<li><code>plot_image_with_cuboid()</code> å‡½æ•°å®Œæˆã€‚</li>
</ul>
<hr>
<blockquote>
<p>2019.02.22     <br>
<a href="mailto:wuyanminmax@gmail.com">wuyanminmax@gmail.com</a></p>
</blockquote>

    </div>

    
<footer class="post-footer">
      
      <nav class="post-nav">
        <a class="prev" href="/2019-02-27-object-ba/">
            <i class="iconfont icon-left"></i>
            <span class="prev-text nav-default"> ğŸ“œ è®ºæ–‡é˜…è¯» | ä½¿ç”¨ç‰©ä½“è¡¥å……çš„ BA æ¥æ¢å¤å•ç›® SLAM çš„ç¨³å®šå°ºåº¦</span>
            <span class="prev-text nav-mobile">ä¸Šä¸€ç¯‡</span>
          </a>
        <a class="next" href="/2019-01-28-quadric-slam/">
            <span class="next-text nav-default"> ğŸ“œ è®ºæ–‡é˜…è¯» | Quadric SLAMï¼šä»¥ç›®æ ‡æ£€æµ‹è·å¾—çš„å¯¹å¶äºŒæ¬¡æ›²é¢ä¸ºé¢å‘ç‰©ä½“ SLAM çš„è·¯æ ‡</span>
            <span class="next-text nav-mobile">ä¸‹ä¸€ç¯‡</span>
            <i class="iconfont icon-right"></i>
          </a>
      </nav>
    </footer>
  </article>
        </div>
        

  

  

      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="social-links">
      <a href="wuyanminmax@gmail.com" class="iconfont icon-email" title="email"></a>
      <a href="https://github.com/wuxiaolang" class="iconfont icon-github" title="github"></a>
      <a href="https://www.zhihu.com/people/wuyanmin2018" class="iconfont icon-zhihu" title="zhihu"></a>
  <a href="https://wym.netlify.app/index.xml" type="application/rss+xml" class="iconfont icon-rss" title="rss"></a>
</div>

<div class="copyright">
  
  

  
  <div class="busuanzi-footer">
    
      
    
  </div>

  <span class="copyright-year">
    &copy; 
    2019 - 
    2020
    <span class="heart">
      <i class="iconfont icon-heart"></i>
    </span>
    <span class="author">wu</span>
  </span>
</div>
    </footer>

    <div class="back-to-top" id="back-to-top">
      <i class="iconfont icon-up"></i>
    </div>
  </div>
  
  <script src="https://cdn.jsdelivr.net/npm/jquery@3.2.1/dist/jquery.min.js" integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/slideout@1.0.1/dist/slideout.min.js" integrity="sha256-t+zJ/g8/KXIJMjSVQdnibt4dlaDxc9zXr/9oNPeWqdg=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.1.20/dist/jquery.fancybox.min.js" integrity="sha256-XVLffZaxoWfGUEbdzuLi7pwaUJv1cecsQJQqGLe7axY=" crossorigin="anonymous"></script>
<script type="text/javascript" src="/dist/even.26188efa.min.js"></script>
  <script type="text/javascript">
    window.MathJax = {
      tex2jax: {inlineMath: [['$','$'], ['\\(','\\)']]},
      TeX: {equationNumbers: {autoNumber: "AMS"}},
      showProcessingMessages: false,
      messageStyle: 'none'
    };
  </script>
  <script async src="https://cdn.jsdelivr.net/npm/mathjax@2.7.5/MathJax.js?config=TeX-MML-AM_CHTML"  integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>


<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
	ga('create', 'UA-160646347-2', 'auto');
	ga('set', 'anonymizeIp', true);
	ga('send', 'pageview');
}
</script>
<script async src='https://www.google-analytics.com/analytics.js'></script>
<script id="baidu_analytics">
  var _hmt = _hmt || [];
  (function() {
    if (window.location.hostname === 'localhost') return;
    var hm = document.createElement("script"); hm.async = true;
    hm.src = "https://hm.baidu.com/hm.js?352520a6e7c1df580f6de1f879049608";
    var s = document.getElementsByTagName("script")[0];
    s.parentNode.insertBefore(hm, s);
  })();
</script>

<script id="baidu_push">
  (function(){
    if (window.location.hostname === 'localhost') return;
    var bp = document.createElement('script'); bp.async = true;
    var curProtocol = window.location.protocol.split(':')[0];
    if (curProtocol === 'https') {
      bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';
    }
    else {
      bp.src = 'http://push.zhanzhang.baidu.com/push.js';
    }
    var s = document.getElementsByTagName("script")[0];
    s.parentNode.insertBefore(bp, s);
  })();
</script>




</body>
</html>
